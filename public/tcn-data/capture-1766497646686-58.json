{
  "url": "https://os.ourvend.com/SaleSummarize/Index",
  "status": 200,
  "contentType": "text/html; charset=utf-8",
  "body": "\r\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\r\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\r\n<head>\r\n    <meta charset=\"utf-8\">\r\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\r\n    <meta name=\"viewport\" content=\"width=device-width,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no\" />\r\n    <title>Sales summary</title>\r\n    <link href=\"../../Content/style.min.css\" rel=\"stylesheet\" />\r\n    <link href=\"../../Content/animate.min.css\" rel=\"stylesheet\" />\r\n    <link type=\"text/css\" href=\"../../Content/bootstrap/css/bootstrap.min.css\" rel=\"Stylesheet\">\r\n    <link type=\"text/css\" href=\"../../Content/jqGridBootstrap/css/ui.jqgrid-bootstrap.css\" rel=\"Stylesheet\" />\r\n    <link type=\"text/css\" href=\"../../Content/bootstrap/css/bootstrap-select.min.css\" rel=\"Stylesheet\" />\r\n    <script type=\"text/javascript\" src=\"../../Content/bootstrap/js/jquery-1.9.1.js\"></script>\r\n    <script type=\"text/javascript\" src=\"../../Content/bootstrap/js/bootstrap.min.js\"></script>\r\n    <script type=\"text/javascript\" src=\"/Content/jqGridBootstrap/js/i18n/grid.locale-en.js\"></script>\r\n    <script type=\"text/javascript\" src=\"/Content/jqGridBootstrap/js/jquery.jqGrid.js\"></script>\r\n    <script type=\"text/javascript\" src=\"../../Content/Scripts/JqueryToTableData.js\"></script>\r\n    <script type=\"text/javascript\" src=\"../../Content/Scripts/JsontoCSV.js\"></script>\r\n    <script type=\"text/javascript\" src=\"../../Content/bootstrap/js/bootstrap-select.min.js\"></script>\r\n    <script type=\"text/javascript\" src=\"../../Content/Scripts/My97DatePicker/WdatePicker.js\"></script>\r\n    <script type=\"text/javascript\" src=\"../../Content/Scripts/ECharts/build/dist/echarts.js\"></script>\r\n    <script type=\"text/javascript\" src=\"../../Content/Scripts/EchartsHelp.js\"></script>\r\n       <script src=\"../../Content/MyJS.js\" type=\"text/javascript\"></script>\r\n    <script type=\"text/javascript\">\r\n        var width = 0;\r\n        var Table_index; //表头\r\n        var Table_Name; //导出Csv的名称\r\n        var columMl = \"\";\r\n        $(document).ready(function () {\r\n            $(\"#ProShow\").hide();\r\n            $(\"#body\").height(window.screen.height * 0.81);\r\n            $(\"[data-toggle='tooltip']\").tooltip();\r\n            $('.selectpicker').selectpicker({\r\n                size: 4\r\n            });\r\n            $.post(\"/SaleSummarize/getSession\", \"\", function (data) {\r\n                if (data == \"True\") {\r\n                    GetMachineGroup();\r\n                    GetProductNameList();\r\n\r\n                    load_require(\"bar_line\", \"pie\", div_bar_line, div_pie);\r\n                    $(\"#GraphType\").change(function () {\r\n                        switch ($(\"#GraphType\").val()) {\r\n                            case \"0\":\r\n                                $(\"#SaleSummarizeHeight\").show();\r\n                                $(\"#bar_line\").hide();\r\n                                $(\"#pie\").hide();\r\n                                break;\r\n                            case \"1\":\r\n                                if (JqueryData(\"jqGrid\").length < 2) {\r\n                                    Modal_Message(\"Message Box\", \"No data, unable to display graphics\");\r\n                                    return;\r\n                                }\r\n                                $(\"#SaleSummarizeHeight\").hide();\r\n                                $(\"#bar_line\").show();\r\n                                $(\"#pie\").hide();\r\n\r\n                                SetEchartData(Table_index, JqueryDatas(\"jqGrid\"), \"bar\");\r\n                                set_data(\"柱型\", legenddata, xAxisdata, seriesdata, div_bar_line);\r\n                                set_data(\"柱型\", legenddata, xAxisdata, seriesdata, div_bar_line);\r\n\r\n                                Data.xAxis[0].name = \"Total amount (yuan)\";\r\n                                Data.xAxis[0].nameLocation = 'start';\r\n                                Data.xAxis[0].data = [\"\"];\r\n                                Data.series[0].label = { show: true, position: 'top', }; \r\n                                 \r\n                                div_bar_line.clear();\r\n                                div_bar_line.setOption(Data);\r\n                                div_bar_line.resize();\r\n                                break;\r\n                            case \"2\":\r\n                                if (JqueryData(\"jqGrid\").length < 2) {\r\n                                    Modal_Message(\"Message Box\", \"No data, unable to display graphics\");\r\n                                    return;\r\n                                }\r\n                                $(\"#SaleSummarizeHeight\").hide();\r\n                                $(\"#bar_line\").show();\r\n                                $(\"#pie\").hide();\r\n                                SetEchartData(Table_index, JqueryDatas(\"jqGrid\"), \"line\");\r\n                                set_data(\"柱型\", legenddata, xAxisdata, seriesdata, div_bar_line);\r\n                                set_data(\"柱型\", legenddata, xAxisdata, seriesdata, div_bar_line); \r\n                                Data.xAxis[0].name = \"Amount / yuan    \";\r\n                                Data.xAxis[0].nameLocation = 'start'; \r\n                                div_bar_line.clear();\r\n                                div_bar_line.setOption(Data);\r\n                                div_bar_line.resize();\r\n                                break;\r\n                            case \"3\":\r\n                                if (JqueryData(\"jqGrid\").length < 2) {\r\n                                    Modal_Message(\"Message Box\", \"No data, unable to display graphics\");\r\n                                    return;\r\n                                }\r\n                                $(\"#SaleSummarizeHeight\").hide();\r\n                                $(\"#bar_line\").hide();\r\n                                $(\"#pie\").show();\r\n                                SetEchartData(Table_index, JqueryDatas(\"jqGrid\"), \"pie\");\r\n                                set_data(\"饼型\", legenddata, xAxisdata, seriesdata, div_pie);\r\n                                set_data(\"饼型\", legenddata, xAxisdata, seriesdata, div_pie);\r\n                                 \r\n                                  \r\n                                Data.series[0].label = { formatter: '{b}:{c}({d}%) ' };\r\n                                div_pie.clear();\r\n                                div_pie.setOption(Data);\r\n                                div_pie.resize(); \r\n                                break;\r\n                        }\r\n                    });\r\n                } else {\r\n                    window.parent.getSessInfo();\r\n                }\r\n            });\r\n            GetReserveList();\r\n\r\n        });\r\n\r\n        function GridUnload() {\r\n            $(\"#SaleSummarizeHeight\").empty();\r\n            $(\"#SaleSummarizeHeight\").html(\"<table id='jqGrid'></table><div id='jqGridPager'></div>\");\r\n        }\r\n        //返回绑定grid数据\r\n        function GetColumgrid(colum, obj1, obj2, obj3) {\r\n            var Gridcolum = new Array();\r\n            console.log(colum);\r\n            console.log(obj1);\r\n            if (obj1 == \"TrBarCode\") {\r\n                for (var j = 0; j < colum.length; j++) {\r\n                    var columName = new Object();\r\n                    if (j == 0) {\r\n                        columName.name = obj1;\r\n                        columName.index = obj1;\r\n                        columName.width = 1;\r\n                        columName.hidden = true;\r\n                        columName.key = true;\r\n                        Gridcolum.push(columName);\r\n\r\n                    } else if (j == 1) {\r\n                        columName.name = obj2;\r\n                        columName.index = obj2;\r\n                        columName.width = 84;\r\n                        columName.align = \"center\";\r\n                        columName.shrinkToFit = true;\r\n                        columName.sortable = true;\r\n                        columName.hidden = false;\r\n                        Gridcolum.push(columName);\r\n\r\n                    }\r\n                    else if (j == 2) {\r\n                        columName.name = obj3;\r\n                        columName.index = obj3;\r\n                        columName.shrinkToFit = true;\r\n                        columName.sortable = true;\r\n                        columName.width = 74;\r\n                        columName.align = \"center\";\r\n                        columName.hidden = false;\r\n                        Gridcolum.push(columName);\r\n                    } else if (j == colum.length - 1) {\r\n                        columName.name = \"colum00\";\r\n                        columName.index = \"colum00\"\r\n                        columName.shrinkToFit = true;\r\n                        columName.sortable = true;\r\n                        columName.width = 74;\r\n                        columName.align = \"center\";\r\n                        columName.hidden = false;\r\n                        columName.formatter = ActionFormatter3;\r\n                        Gridcolum.push(columName);\r\n                    } else if (j == colum.length - 2) {\r\n                        columName.name = \"colum0\";\r\n                        columName.index = \"colum0\";\r\n                        columName.width = 74;\r\n                        columName.align = \"center\";\r\n                        columName.shrinkToFit = true;\r\n                        columName.sortable = true;\r\n                        columName.hidden = false;\r\n                        columName.formatter = ActionFormatter3;\r\n                        Gridcolum.push(columName);\r\n                    } else if (j == colum.length - 3 && obj1 == \"TrBarCode\") {\r\n                        columMl = \"colum\" + (j - 4);\r\n                        columName.name = \"colum\" + (j - 3);\r\n                        columName.index = \"colum\" + (j - 3);\r\n                        columName.shrinkToFit = true;\r\n                        columName.sortable = true;\r\n                        columName.width = 74;\r\n                        columName.align = \"center\";\r\n                        columName.hidden = false;\r\n                        columName.formatter = ActionFormatter2;\r\n                        Gridcolum.push(columName);\r\n                    } else if (j == colum.length - 4 && obj1 == \"TrBarCode\") {\r\n                        columName.name = \"mlv\";\r\n                        columName.index = \"mlv\";\r\n                        columName.shrinkToFit = true;\r\n                        columName.sortable = false;\r\n                        columName.width = 74;\r\n                        columName.align = \"center\";\r\n                        columName.hidden = false;\r\n                        columName.formatter = ActionMaoli;\r\n                        Gridcolum.push(columName);\r\n                    } else {\r\n                        columName.name = \"colum\" + (j - 2);\r\n                        columName.index = \"colum\" + (j - 2);\r\n                        columName.shrinkToFit = true;\r\n                        columName.sortable = true;\r\n                        columName.align = \"center\";\r\n                        if (j % 2 == 1) {\r\n                            columName.width = 74;\r\n                        } else {\r\n                            columName.width = 40;\r\n                        }\r\n                        columName.hidden = false;\r\n                        Gridcolum.push(columName);\r\n                    }\r\n                }\r\n            }\r\n            else if (obj1 == \"TrBarCodePro\") {\r\n                for (var j = 0; j < colum.length; j++) {\r\n                    var columName = new Object();\r\n                    if (j == 0) {\r\n                        columName.name = obj1;\r\n                        columName.index = obj1;\r\n                        columName.width = 1;\r\n                        columName.hidden = true;\r\n                        columName.key = true;\r\n                        Gridcolum.push(columName);\r\n\r\n                    } else if (j == 1) {\r\n                        columName.name = \"MGName\";\r\n                        columName.index = \"MGName\";\r\n                        columName.width = 84;\r\n                        columName.align = \"center\";\r\n                        columName.shrinkToFit = true;\r\n                        columName.sortable = true;\r\n                        columName.hidden = false;\r\n                        Gridcolum.push(columName);\r\n\r\n                    }\r\n                    else if (j == 2) {\r\n                        columName.name = \"MuMachineID\";\r\n                        columName.index = \"MuMachineID\";\r\n                        columName.shrinkToFit = true;\r\n                        columName.sortable = true;\r\n                        columName.width = 74;\r\n                        columName.align = \"center\";\r\n                        columName.hidden = false;\r\n                        Gridcolum.push(columName);\r\n                    }\r\n                    else if (j == 3) {\r\n                        columName.name = \"MiAlias\";\r\n                        columName.index = \"MiAlias\";\r\n                        columName.shrinkToFit = true;\r\n                        columName.sortable = true;\r\n                        columName.width = 100;\r\n                        columName.align = \"center\";\r\n                        columName.hidden = false;\r\n                        Gridcolum.push(columName);\r\n                    }\r\n                    else if (j == 4) {\r\n                        columName.name = obj2;\r\n                        columName.index = obj2;\r\n                        columName.width = 84;\r\n                        columName.align = \"center\";\r\n                        columName.shrinkToFit = true;\r\n                        columName.sortable = true;\r\n                        columName.hidden = false;\r\n                        Gridcolum.push(columName);\r\n\r\n                    }\r\n                    else if (j == 5) {\r\n                        columName.name = obj3;\r\n                        columName.index = obj3;\r\n                        columName.shrinkToFit = true;\r\n                        columName.sortable = true;\r\n                        columName.width = 74;\r\n                        columName.align = \"center\";\r\n                        columName.hidden = false;\r\n                        Gridcolum.push(columName);\r\n                    }\r\n\r\n                    else if (j == colum.length - 1) {\r\n                        columName.name = \"colum00\";\r\n                        columName.index = \"colum00\"\r\n                        columName.shrinkToFit = true;\r\n                        columName.sortable = true;\r\n                        columName.width = 74;\r\n                        columName.align = \"center\";\r\n                        columName.hidden = false;\r\n                        columName.formatter = ActionFormatter3;\r\n                        Gridcolum.push(columName);\r\n                    } else if (j == colum.length - 2) {\r\n                        columName.name = \"colum0\";\r\n                        columName.index = \"colum0\";\r\n                        columName.width = 74;\r\n                        columName.align = \"center\";\r\n                        columName.shrinkToFit = true;\r\n                        columName.sortable = true;\r\n                        columName.hidden = false;\r\n                        columName.formatter = ActionFormatter3;\r\n                        Gridcolum.push(columName);\r\n                    } else {\r\n                        columName.name = \"colum\" + (j - 5);\r\n                        columName.index = \"colum\" + (j - 5);\r\n                        columName.shrinkToFit = true;\r\n                        columName.sortable = true;\r\n                        columName.align = \"center\";\r\n                        if (j % 2 == 1) {\r\n                            columName.width = 74;\r\n                        } else {\r\n                            columName.width = 40;\r\n                        }\r\n                        columName.hidden = false;\r\n                        Gridcolum.push(columName);\r\n                    }\r\n                }\r\n            }\r\n\r\n            else if (obj3 == \"MachineName\") {\r\n                for (var j = 0; j < colum.length; j++) {\r\n                    var columName = new Object();\r\n                    if (j == 0) {\r\n                        columName.name = obj1;\r\n                        columName.index = obj1;\r\n                        columName.width = 1;\r\n                        columName.hidden = true;\r\n                        columName.key = true;\r\n                        Gridcolum.push(columName);\r\n\r\n                    } else if (j == 1) {\r\n                        columName.name = \"MGName\";\r\n                        columName.index = \"MGName\";\r\n                        columName.width = 90;\r\n                        columName.align = \"center\";\r\n                        columName.shrinkToFit = true;\r\n                        columName.sortable = true;\r\n                        columName.hidden = false;\r\n                        columName.cellattr = ActionFormatter4;\r\n                        Gridcolum.push(columName);\r\n\r\n                    }\r\n                    else if (j == 2) {\r\n                        columName.name = obj2;\r\n                        columName.index = obj2;\r\n                        columName.width = 90;\r\n                        columName.align = \"center\";\r\n                        columName.shrinkToFit = true;\r\n                        columName.sortable = true;\r\n                        columName.hidden = false;\r\n                        Gridcolum.push(columName);\r\n                    }\r\n                    else if (j == 3) {\r\n                        columName.name = obj3;\r\n                        columName.index = obj3;\r\n                        columName.shrinkToFit = true;\r\n                        columName.sortable = true;\r\n                        columName.width = 90;\r\n                        columName.align = \"center\";\r\n                        columName.hidden = false;\r\n                        Gridcolum.push(columName);\r\n                    } \r\n                    else if (j == colum.length - 1) {\r\n                        columName.name = \"colum00\";\r\n                        columName.index = \"colum00\"\r\n                        columName.shrinkToFit = true;\r\n                        columName.sortable = true;\r\n                        columName.width = 74;\r\n                        columName.align = \"center\";\r\n                        columName.hidden = false;\r\n                        columName.formatter = ActionFormatter3;\r\n                        Gridcolum.push(columName);\r\n                    } else if (j == colum.length - 2) {\r\n                        columName.name = \"colum0\";\r\n                        columName.index = \"colum0\";\r\n                        columName.width = 74;\r\n                        columName.align = \"center\";\r\n                        columName.shrinkToFit = true;\r\n                        columName.sortable = true;\r\n                        columName.hidden = false;\r\n                        columName.formatter = ActionFormatter3;\r\n                        Gridcolum.push(columName);\r\n                    } else if (j == colum.length - 3 && obj1 == \"TrMachine\") {\r\n                        columMl = \"colum\" + (j - 5);\r\n                        columName.name = \"colum\" + (j - 4);\r\n                        columName.index = \"colum\" + (j - 4);\r\n                        columName.shrinkToFit = true;\r\n                        columName.sortable = true;\r\n                        columName.width = 74;\r\n                        columName.align = \"center\";\r\n                        columName.hidden = false;\r\n                        columName.formatter = ActionFormatter2;\r\n                        Gridcolum.push(columName);\r\n                    } else if (j == colum.length - 4 && obj1 == \"TrMachine\") {\r\n                        columName.name = \"mlv\";\r\n                        columName.index = \"mlv\";\r\n                        columName.shrinkToFit = true;\r\n                        columName.sortable = false;\r\n                        columName.width = 74;\r\n                        columName.align = \"center\";\r\n                        columName.hidden = false;\r\n                        columName.formatter = ActionMaoli;\r\n                        Gridcolum.push(columName);\r\n                    }\r\n                    else {\r\n                        columName.name = \"colum\" + (j - 3);\r\n                        columName.index = \"colum\" + (j - 3);\r\n                        columName.shrinkToFit = true;\r\n                        columName.sortable = true;\r\n                        columName.align = \"center\";\r\n                        if (j % 2 == 1) {\r\n                            columName.width = 40;\r\n                        } else {\r\n                            columName.width = 74;\r\n                        }\r\n                        columName.hidden = false;\r\n                        Gridcolum.push(columName);\r\n                    }\r\n                }\r\n            }\r\n            else {\r\n                \r\n                for (var j = 0; j < colum.length; j++) {\r\n                    var columName = new Object();\r\n                    if (j == 0) {\r\n                        columName.name = obj1;\r\n                        columName.index = obj1;\r\n                        columName.width = 1;\r\n                        columName.hidden = true;\r\n                        columName.key = true;\r\n                        Gridcolum.push(columName);\r\n\r\n                    } else if (j == 1 && obj1 == \"TrMachine\") {\r\n                        columName.name = obj2;\r\n                        columName.index = obj2;\r\n                        columName.width = 84;\r\n                        columName.align = \"center\";\r\n                        columName.shrinkToFit = true;\r\n                        columName.sortable = true;\r\n                        columName.hidden = false;\r\n                        Gridcolum.push(columName);\r\n\r\n                    } else if (j == 1 && obj1 != \"TrMachine\") {\r\n                        columName.name = obj2;\r\n                        columName.index = obj2;\r\n                        columName.shrinkToFit = true;\r\n                        columName.sortable = true;\r\n                        columName.width = 74;\r\n                        columName.align = \"center\";\r\n                        columName.hidden = true;\r\n                        Gridcolum.push(columName);\r\n                    }\r\n                    else if (j == 2) {\r\n                        columName.name = obj3;\r\n                        columName.index = obj3;\r\n                        columName.shrinkToFit = true;\r\n                        columName.sortable = true;\r\n                        columName.width = 74;\r\n                        columName.align = \"center\";\r\n                        columName.hidden = false;\r\n                        Gridcolum.push(columName);\r\n                    } else if (j == colum.length - 1) {\r\n                        columName.name = \"colum00\";\r\n                        columName.index = \"colum00\"\r\n                        columName.shrinkToFit = true;\r\n                        columName.sortable = true;\r\n                        columName.width = 74;\r\n                        columName.align = \"center\";\r\n                        columName.hidden = false;\r\n                        columName.formatter = ActionFormatter3;\r\n                        Gridcolum.push(columName);\r\n                    } else if (j == colum.length - 2) {\r\n                        columName.name = \"colum0\";\r\n                        columName.index = \"colum0\";\r\n                        columName.width = 74;\r\n                        columName.align = \"center\";\r\n                        columName.shrinkToFit = true;\r\n                        columName.sortable = true;\r\n                        columName.hidden = false;\r\n                        columName.formatter = ActionFormatter3;\r\n                        Gridcolum.push(columName);\r\n                    } else if (j == colum.length - 3 && obj1 == \"TrBarCode\") {\r\n                        columMl = \"colum\" + (j - 4);\r\n                        columName.name = \"colum\" + (j - 3);\r\n                        columName.index = \"colum\" + (j - 3);\r\n                        columName.shrinkToFit = true;\r\n                        columName.sortable = true;\r\n                        columName.width = 74;\r\n                        columName.align = \"center\";\r\n                        columName.hidden = false;\r\n                        columName.formatter = ActionFormatter2;\r\n                        Gridcolum.push(columName);\r\n                    } else if (j == colum.length - 4 && obj1 == \"TrBarCode\") {\r\n                        columName.name = \"mlv\";\r\n                        columName.index = \"mlv\";\r\n                        columName.shrinkToFit = true;\r\n                        columName.sortable = false;\r\n                        columName.width = 74;\r\n                        columName.align = \"center\";\r\n                        columName.hidden = false;\r\n                        columName.formatter = ActionMaoli;\r\n                        Gridcolum.push(columName);\r\n                    } else {\r\n                        columName.name = \"colum\" + (j - 2);\r\n                        columName.index = \"colum\" + (j - 2);\r\n                        columName.shrinkToFit = true;\r\n                        columName.sortable = true;\r\n                        columName.align = \"center\";\r\n                        if (j % 2 == 1) {\r\n                            columName.width = 74;\r\n                        } else {\r\n                            columName.width = 40;\r\n                        }\r\n                        columName.hidden = false;\r\n                        Gridcolum.push(columName);\r\n                    }\r\n                }\r\n            }\r\n            console.log(Gridcolum);\r\n            return Gridcolum;\r\n        }\r\n\r\n        function GetSelectedItems() {\r\n            return $(\"#jqGrid\").getGridParam('selarrrow');\r\n        }\r\n        //生存grid 表头\r\n        function GetColum(colum, obj) {\r\n            var arrColum = new Array();\r\n            if (obj == \"TrMachine\") {\r\n                arrColum.push(\"TrMachine\");\r\n                arrColum.push(\"Machine group name\");\r\n                arrColum.push(\"Machine ID\");\r\n                arrColum.push(\"Machine name \");\r\n            }\r\n\r\n            if (obj == \"TrBarCode\") {\r\n                arrColum.push(\"TrBarCode\");\r\n                arrColum.push(\"Commodity code\");\r\n                arrColum.push(\"Product name\");\r\n            }\r\n            if (obj == \"TrBarCodePro\") {\r\n                arrColum.push(\"TrBarCodePro\");\r\n                arrColum.push(\"Machine group name\");\r\n                arrColum.push(\"Machine ID\");\r\n                arrColum.push(\"Machine name \");\r\n                arrColum.push(\"Commodity code\");\r\n                     arrColum.push(\"Product name\");\r\n                 }\r\n            if (obj == \"PrType\") {\r\n                arrColum.push(\"PrType\");\r\n                arrColum.push(\"Type\");\r\n                arrColum.push(\"Commodity type\");\r\n            }\r\n            for (var i = 0; i < colum.length; i++) {\r\n                switch (colum[i]) {\r\n                    case \"0\":\r\n                        arrColum.push(\"Pay by cash \");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"1\":\r\n                        arrColum.push(\"Pay with Union Pay cards\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"2\":\r\n                        arrColum.push(\"Pay by membership card \");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"4\":\r\n                        arrColum.push(\"Membership Card 1 Payment\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"5\":\r\n                        arrColum.push(\"Pay with Union Pay cards\" + \"1\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"11\":\r\n                        arrColum.push(\"WeChat payment\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"12\":\r\n                        arrColum.push(\"Alipay face-to-face pay\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"13\":\r\n                        arrColum.push(\"Alipay QR Pay\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"15\":\r\n                        arrColum.push(\"Gift \");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"16\":\r\n                        arrColum.push(\"One Key\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"17\":\r\n                        arrColum.push(\"Payment with pick-up code \");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"18\":\r\n                        arrColum.push(\"Unionpay wallet\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"65\":\r\n                        arrColum.push(\"WeChat payment\" + \"(H)\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"66\":\r\n                        arrColum.push(\"Alipay QR Pay\" + \"(H)\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"67\":\r\n                        arrColum.push(\"JD.COM\" + \"(H)\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"68\":\r\n                        arrColum.push(\"WeChat games (One yuan for luck)\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"69\":\r\n                        arrColum.push(\"Bestpay\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"70\":\r\n                        arrColum.push(\"ICBC QR code payment\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"71\":\r\n                        arrColum.push(\"WeChat membership card\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"72\":\r\n                        arrColum.push(\"Qpay\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;  \r\n                    case \"73\":\r\n                        arrColum.push(\"Unionpay business\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"74\":\r\n                        arrColum.push(\"PingAn E e-payment\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"75\":\r\n                        arrColum.push(\"WeChat pay by face recognition\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"76\":\r\n                        arrColum.push(\"Alipay face recognition payment\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"77\":\r\n                        arrColum.push(\"Jd aggregate payment\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"79\":\r\n                        arrColum.push(\"Lichu Payment\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"89\":\r\n                        arrColum.push(\"AlipayNFC\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"90\":\r\n                        arrColum.push(\"Hubtel Pay\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"92\":\r\n                        arrColum.push(\"Midtrans Pay\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"93\":\r\n                        arrColum.push(\"Paycools Pay\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"94\":\r\n                        arrColum.push(\"KHQR Pay\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"101\":\r\n                        arrColum.push(\"Remote Shipment\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"88\":\r\n                        arrColum.push(\"UnionPay Digital Currency\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"255\":\r\n                        arrColum.push(\"Other\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                }\r\n            }\r\n            if (obj == \"TrBarCode\" || obj == \"PrType\" || obj == \"TrMachine\") {\r\n                arrColum.push(\"Profit\");\r\n                arrColum.push(\"Gross margin\");\r\n                arrColum.push(\"Proportion\");\r\n\r\n            }\r\n            arrColum.push(\"Total amount\");\r\n            arrColum.push(\"Total quantity\");\r\n            return arrColum;\r\n        }\r\n\r\n\r\n        //生存excle 表头\r\n        function GetExcelColum(colum, obj) {\r\n            var arrColum = new Array();\r\n            if (obj == \"TrMachine\") {\r\n                arrColum.push(\"TrMachine\");\r\n                arrColum.push(\"Product code\");\r\n                arrColum.push(\"Product name\");\r\n                arrColum.push(\"Machine group name\");\r\n            }\r\n            if (obj == \"TrBarCode\") {\r\n                arrColum.push(\"ProductID\");\r\n                arrColum.push(\"Commodity code\");\r\n                arrColum.push(\"Product name\");\r\n            }\r\n            if (obj == \"TrBarCodePro\") {\r\n\r\n                arrColum.push(\"TrBarCodePro\");\r\n                arrColum.push(\"Machine name \");\r\n                arrColum.push(\"Machine group name\");\r\n                arrColum.push(\"Machine ID\");\r\n   \r\n                arrColum.push(\"Commodity code\");\r\n                arrColum.push(\"Product name\");\r\n\r\n            }\r\n\r\n            if (obj == \"PrType\") {\r\n                arrColum.push(\"PrType\");\r\n                arrColum.push(\"Type\");\r\n                arrColum.push(\"Commodity type\");\r\n            }\r\n            for (var i = 0; i < colum.length; i++) {\r\n                switch (colum[i]) {\r\n                    case \"0\":\r\n                        arrColum.push(\"Pay by cash \");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"1\":\r\n                        arrColum.push(\"Pay with Union Pay cards\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"2\":\r\n                        arrColum.push(\"Pay by membership card \");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"4\":\r\n                        arrColum.push(\"Membership Card 1 Payment\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"5\":\r\n                        arrColum.push(\"Pay with Union Pay cards\" + \"1\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"11\":\r\n                        arrColum.push(\"WeChat payment\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"12\":\r\n                        arrColum.push(\"Alipay face-to-face pay\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"13\":\r\n                        arrColum.push(\"Alipay QR Pay\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"15\":\r\n                        arrColum.push(\"Gift \");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"16\":\r\n                        arrColum.push(\"One Key\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"17\":\r\n                        arrColum.push(\"Payment with pick-up code \");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"18\":\r\n                        arrColum.push(\"Unionpay wallet\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"65\":\r\n                        arrColum.push(\"WeChat payment\" + \"(H)\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"66\":\r\n                        arrColum.push(\"Alipay QR Pay\" + \"(H)\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"67\":\r\n                        arrColum.push(\"JD.COM\" + \"(H)\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"68\":\r\n                        arrColum.push(\"WeChat games (One yuan for luck)\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"69\":\r\n                        arrColum.push(\"Bestpay\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"70\":\r\n                        arrColum.push(\"ICBC QR code payment\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"71\":\r\n                        arrColum.push(\"WeChat membership card\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"72\":\r\n                        arrColum.push(\"QQ wallet\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"73\":\r\n                        arrColum.push(\"Unionpay business\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"255\":\r\n                        arrColum.push(\"Other\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"74\":\r\n                        arrColum.push(\"PingAn E e-payment\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"75\":\r\n                        arrColum.push(\"WeChat brush face\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"76\":\r\n                        arrColum.push(\"Alipay brush face\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"77\":\r\n                        arrColum.push(\"Jd aggregate payment\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"79\":\r\n                        arrColum.push(\"Lichu Payment\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"89\":\r\n                        arrColum.push(\"AlipayNFC\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"88\":\r\n                        arrColum.push(\"UnionPay Digital Currency\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"90\":\r\n                        arrColum.push(\"Hubtel Pay\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"92\":\r\n                        arrColum.push(\"Midtrans Pay\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"93\":\r\n                        arrColum.push(\"Paycools Pay\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"94\":\r\n                        arrColum.push(\"KHQR Pay\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"101\":\r\n                        arrColum.push(\"Remote Shipment\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                }\r\n            }\r\n            \r\n            if (obj == \"TrBarCode\" || obj == \"PrType\") {\r\n                arrColum.push(\"Profit\");\r\n                arrColum.push(\"Proportion\");\r\n            }\r\n            \r\n            arrColum.push(\"Total amount\");\r\n            arrColum.push(\"Total quantity\");\r\n       \r\n            return arrColum;\r\n        }\r\n\r\n        function GetExcelIndex(colum, obj) {\r\n            var arrColum = new Array();\r\n            if (obj == \"TrMachine\") {\r\n                arrColum.push(\"TrMachine\");\r\n                arrColum.push(\"Machine ID\");\r\n                arrColum.push(\"Name of machine\");\r\n                arrColum.push(\"Machine name \");                \r\n            }\r\n            if (obj == \"TrBarCode\") {\r\n                arrColum.push(\"ProductID\"); \r\n                arrColum.push(\"Commodity code\");\r\n                arrColum.push(\"Product name\");\r\n            }\r\n            if (obj == \"PrType\") {\r\n                arrColum.push(\"PrType\");\r\n                arrColum.push(\"Type\");\r\n                arrColum.push(\"Commodity type\");\r\n            }\r\n            for (var i = 0; i < colum.length; i++) {\r\n                switch (colum[i]) {\r\n                    case \"0\":\r\n                        arrColum.push(\"Pay by cash \");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"1\":\r\n                        arrColum.push(\"Pay with Union Pay cards\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"2\":\r\n                        arrColum.push(\"Pay by membership card \");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"4\":\r\n                        arrColum.push(\"Membership Card 1 Payment\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"5\":\r\n                        arrColum.push(\"Pay with Union Pay cards\" + \"1\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"11\":\r\n                        arrColum.push(\"WeChat payment\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"12\":\r\n                        arrColum.push(\"Alipay face-to-face pay\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"13\":\r\n                        arrColum.push(\"Alipay QR Pay\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"15\":\r\n                        arrColum.push(\"Gift \");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"16\":\r\n                        arrColum.push(\"One Key\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"17\":\r\n                        arrColum.push(\"Payment with pick-up code \");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"18\":\r\n                        arrColum.push(\"Unionpay wallet\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"65\":\r\n                        arrColum.push(\"WeChat payment\" + \"(H)\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"66\":\r\n                        arrColum.push(\"Alipay QR Pay\" + \"(H)\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"67\":\r\n                        arrColum.push(\"JD.COM\" + \"(H)\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"68\":\r\n                        arrColum.push(\"WeChat games (One yuan for luck)\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"69\":\r\n                        arrColum.push(\"Bestpay\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"70\":\r\n                        arrColum.push(\"ICBC QR code payment\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"71\":\r\n                        arrColum.push(\"WeChat membership card\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"72\":\r\n                        arrColum.push(\"QQ wallet\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"73\":\r\n                        arrColum.push(\"Unionpay business\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"255\":\r\n                        arrColum.push(\"Other\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"74\":\r\n                        arrColum.push(\"PingAn E e-payment\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"75\":\r\n                        arrColum.push(\"WeChat brush face\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"76\":\r\n                        arrColum.push(\"Alipay brush face\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"77\":\r\n                        arrColum.push(\"Jd aggregate payment\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"79\":\r\n                        arrColum.push(\"Lichu Payment\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"89\":\r\n                        arrColum.push(\"AlipayNFC\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"88\":\r\n                        arrColum.push(\"UnionPay Digital Currency\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"90\":\r\n                        arrColum.push(\"Hubtel Pay\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"92\":\r\n                        arrColum.push(\"Midtrans Pay\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"93\":\r\n                        arrColum.push(\"Paycools Pay\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"94\":\r\n                        arrColum.push(\"KHQR Pay\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                    case \"101\":\r\n                        arrColum.push(\"Remote Shipment\");\r\n                        arrColum.push(\"Quantity\");\r\n                        break;\r\n                }\r\n            }\r\n\r\n            if (obj == \"TrBarCode\" || obj == \"PrType\") {\r\n                arrColum.push(\"Profit\");\r\n                arrColum.push(\"Proportion\");\r\n            }\r\n\r\n            arrColum.push(\"Total amount\");\r\n            arrColum.push(\"Total quantity\");\r\n            arrColum.push(\"Product code\");\r\n            arrColum.push(\"Product name\");\r\n            return arrColum;\r\n        }\r\n\r\n        $(window).resize(function () {\r\n            $(\"#jqGrid\").setGridWidth(document.body.clientWidth - 50);\r\n            $(\"#body\").height(document.body.clientHeight * 0.81);\r\n\r\n        });\r\n\r\n\r\n\r\n        //合并单元格\r\n\r\n        function Merger(gridName, CellName) {\r\n\r\n            //得到显示到界面的id集合\r\n\r\n            var showIds = $(\"#\" + gridName + \"\").getDataIDs();\r\n\r\n            //当前显示多少条\r\n\r\n            var length = showIds.length;\r\n\r\n            for (var i = 0; i < length; i++) {\r\n\r\n                //从上到下获取一条信息\r\n\r\n                var before = $(\"#\" + gridName + \"\").jqGrid('getRowData', showIds[i]);\r\n\r\n                //定义合并行数\r\n\r\n                var rowSpanTaxCount = 1;\r\n\r\n                for (j = i + 1; j <= length; j++) {\r\n\r\n                    //和上边的信息对比 如果值一样就合并行数+1 然后设置rowspan 让当前单元格隐藏\r\n\r\n                    var end = $(\"#\" + gridName + \"\").jqGrid('getRowData', showIds[j]);\r\n\r\n                    if (before[CellName] == end[CellName]) {\r\n\r\n                        rowSpanTaxCount++;\r\n\r\n                        $(\"#\" + gridName + \"\").setCell(showIds[j], CellName, '', { display: 'none' });\r\n\r\n                    } else {\r\n\r\n                        rowSpanTaxCount = 1;\r\n\r\n                        break;\r\n\r\n                    }\r\n\r\n                    $(\"#\" + CellName + \"\" + showIds[i] + \"\").attr(\"rowspan\", rowSpanTaxCount);\r\n\r\n                }\r\n\r\n            }\r\n\r\n        }\r\n\r\n\r\n        function ActionFormatter4(rowId, tv, rawObject, cm, rdata) {\r\n            return 'id=\\'MGName' + rowId + \"\\'\";\r\n\r\n        }\r\n      \r\n        ///按年 月 日 统计\r\n        function Picker() {\r\n            switch ($(\"#TimeType\").val()) {\r\n                case \"0\": \r\n                    WdatePicker({\r\n                        dateFmt: 'yyyy-MM-dd', \r\n                        isShowToday: false, isShowClear: false,\r\n                        onpicked: function () {\r\n                            var indexTime = Date.parse($(\"#StartDate\").val().replace(/-/g, \"/\"));\r\n                            var LastTime = Date.parse($(\"#EndDate\").val().replace(/-/g, \"/\"));\r\n                            if (LastTime - indexTime > 31 * 24 * 60 * 60 * 1000) {\r\n                                $(\"#EndDate\").val($(\"#StartDate\").val());\r\n                            } else if (LastTime - indexTime < 0) {\r\n                                $(\"#EndDate\").val($(\"#StartDate\").val());\r\n                            }\r\n                        }\r\n                    })\r\n                    break;\r\n                case \"1\":\r\n                    WdatePicker({ dateFmt: 'yyyy-MM', isShowToday: false, isShowClear: false });\r\n                    $(\"#StartDate\").val(year + \"-\" + Month);\r\n                    break;\r\n                case \"2\":\r\n                    WdatePicker({ dateFmt: 'yyyy', isShowToday: false, isShowClear: false });\r\n                    $(\"#StartDate\").val(year);\r\n                    break;\r\n            }\r\n\r\n        }\r\n\r\n        //结束时间\r\n        function EndDate() {\r\n            ApiType = EndDatePicker(0, \"31\", \"StartDate\", \"1\")\r\n        }\r\n        function RefreshGrid() {\r\n            $(\"#jqGrid\").trigger(\"reloadGrid\");\r\n        }\r\n\r\n        //控制显示时间类型\r\n        function daytype() {\r\n            var oDate = new Date(); //实例一个时间对象； \r\n\r\n            var year = oDate.getFullYear();   //获取系统的年； \r\n\r\n            var Month = oDate.getMonth() + 1;   //获取系统月份，由于月份是从0开始计算，所以要加1 \r\n\r\n            var day = oDate.getDate();\r\n            switch ($(\"#TimeType\").val()) {\r\n                case \"0\":\r\n                    $(\"#StartDate\").val(year + \"-\" + Month + \"-\" + day);\r\n                    $(\"#EndDate\").val(year + \"-\" + Month + \"-\" + day);\r\n                    $(\"#Label\").show();\r\n                    $(\"#EndTime\").show();\r\n                    break;\r\n                case \"1\":\r\n                    $(\"#StartDate\").val(year + \"-\" + Month);\r\n                    $(\"#Label\").hide();\r\n                    $(\"#EndTime\").hide();\r\n                    break;\r\n                case \"2\":\r\n                    $(\"#StartDate\").val(year);\r\n                    $(\"#Label\").hide();\r\n                    $(\"#EndTime\").hide();\r\n                    break;\r\n            }\r\n        }\r\n        function ActionFormatter2(num, options, rowObject) {\r\n            var s = \"0\";\r\n            if (num == null) {\r\n                num = '';\r\n            }\r\n            else {\r\n                num = num.toString().replace(/\\$|\\,/g, '');\r\n                if (isNaN(num))\r\n                    num = \"0\";\r\n                sign = (num == (num = Math.abs(num)));\r\n                num = Math.floor(num * 100 + 0.50000000001);\r\n                cents = num % 100;\r\n                num = Math.floor(num / 100).toString();\r\n                if (cents < 10)\r\n                    cents = \"0\" + cents;\r\n                for (var i = 0; i < Math.floor((num.length - (1 + i)) / 3) ; i++)\r\n                    num = num.substring(0, num.length - (4 * i + 3)) + ',' +\r\n                num.substring(num.length - (4 * i + 3));\r\n                s = (((sign) ? '' : '-') + num + '.' + cents);\r\n            }\r\n            return s + \"%\";\r\n\r\n        }\r\n\r\n        function ActionMaoli(num, options, rowObject) {\r\n            // console.log(columMl + \"|\" + rowObject[columMl] + \"|\" + rowObject[\"colum0\"]);\r\n         \r\n          \r\n            if (rowObject[columMl] == 0 && rowObject[\"colum0\"] == 0) {\r\n                return \"0.00%\";\r\n            } else {\r\n                var value = rowObject[columMl] / rowObject[\"colum0\"] * 100;\r\n                return value.toFixed(2) + \"%\";\r\n            }\r\n    \r\n      \r\n        }\r\n\r\n        function ActionFormatter3(num, options, rowObject) {\r\n            var s = \"0\";\r\n      \r\n            if (num == null) {\r\n                num = '';\r\n            }\r\n            else {\r\n                var value = Math.round(parseFloat(num) * 100) / 100;\r\n                var xsd = value.toString().split(\".\");\r\n                if (xsd.length == 1) {\r\n                    value = value.toString() + \".00\";\r\n                }\r\n                if (xsd.length > 1) {\r\n                    if (xsd[1].length < 2) {\r\n                        value = value.toString() + \"0\";\r\n                    }\r\n                }\r\n                s = value;\r\n            }\r\n            return s;\r\n\r\n        }\r\n        //消息框\r\n        function Modal_Message(Title, Message) {\r\n            $(\"#MessageTitle\").html(Title);\r\n            $(\"#MessageContent\").html(Message);\r\n            $(\"#Role_Message\").modal('show');\r\n        }\r\n\r\n        //预约消息框\r\n        function Modal_Reserve(Title, Message) {\r\n            $(\"#ReserveTitle\").html(Title);\r\n            $(\"#ReserveContent\").html(Message);\r\n            $(\"#Reserve_View\").modal('show');\r\n            console.log(Title, Message);\r\n        }\r\n\r\n        function Modal_Reserve1(Title, Message) {\r\n            $(\"#ReserveTitle1\").html(Title);\r\n            $(\"#ReserveContent1\").html(Message);\r\n            $(\"#Reserve_View1\").modal('show');\r\n        }\r\n\r\n        function Search() {\r\n            $.post(\"/SaleSummarize/getSession\", \"\", function (data) {\r\n                if (data == \"True\") {\r\n         \r\n                    $(\"#Type\").show();\r\n                    $(\"#SaleSummarizeHeight\").show();\r\n                    $(\"#bar_line\").hide();\r\n                    $(\"#pie\").hide();\r\n                    $(\"#GraphType\").val(0);\r\n                    $(\"#GraphType\").selectpicker('refresh');\r\n                    \r\n\r\n                    if ($(\"#TimeType\").val() == 0) {\r\n                        var indexTime = Date.parse($(\"#StartDate\").val().replace(/-/g, \"/\"));\r\n                        var LastTime = Date.parse($(\"#EndDate\").val().replace(/-/g, \"/\"));\r\n                        if (LastTime < indexTime) {\r\n                            Modal_Message(\"Message Box\", \"Cut-off time\");\r\n                            return;\r\n                        }\r\n                        if (LastTime - indexTime > 31 * 24 * 60 * 60 * 1000) {\r\n                            Modal_Message(\"Message Box\", \"Time interval should not be greater than 31 days!\");\r\n                            return;\r\n                        }\r\n                        if ($(\"#StartDate\").val().split('-')[0] != $(\"#EndDate\").val().split('-')[0]) {\r\n                            Modal_Message(\"Message Box\", \"Time interval is less than 1 Year\");\r\n                            return;\r\n                        }\r\n                    }\r\n                    switch ($('#Categories').val()) {\r\n                        case \"0\":\r\n                            GridUnload();\r\n                            $.ajax({\r\n                                url: '/SaleSummarize/TableColumnList1',\r\n                                type: \"post\",\r\n                                datatype: \"json\",\r\n                                data: { \"boxId\": $(\"#boxId\").val(), \"MiGroup\": $(\"#MiGroup\").val(), \"MachineId\": $(\"#MachineID\").val(), \"boxId\": $(\"#boxId\").val(), \"Statistics\": \"0\" },\r\n                                success: function (data) {\r\n                                    if (data.length > 0) {\r\n                                        \r\n                                        var colum = data.split('|');\r\n                                        //商品单独查询\r\n                                        if ($(\"#ProNameSearch\").val() != \"\" && $(\"#ProNameSearch\").val().length > 0) {\r\n                                            SetupProGrid($(\"#grid\"), 1, colum.length * 2, GetColum(colum, \"TrBarCodePro\"), GetColumgrid(GetColum(colum, \"TrBarCodePro\"), \"TrBarCodePro\", \"PrCode\", \"ProductName\", \"PrCode\"));\r\n                                            Table_index = GetColum(colum, \"TrBarCodePro\");\r\n                                            Table_Name = 'Product name' + Time();\r\n                                        } else {\r\n                                            SetupGrid($(\"#grid\"), 1, colum.length * 2, GetColum(colum, \"TrBarCode\"), GetColumgrid(GetColum(colum, \"TrBarCode\"), \"TrBarCode\", \"PrCode\", \"ProductName\", \"PrCode\"));\r\n                                            Table_index = GetColum(colum, \"TrBarCode\");\r\n                                            Table_Name = 'Product name' + Time();\r\n                                        }\r\n                                       \r\n                                        \r\n                                    }\r\n                                }\r\n                            });\r\n                            break;\r\n                        case \"1\":\r\n                            GridUnload();\r\n                            $.ajax({\r\n                                url: '/SaleSummarize/TableColumnList',\r\n                                type: \"post\",\r\n                                datatype: \"json\",\r\n                                data: { \"boxId\": $(\"#boxId\").val(), \"MiGroup\": $(\"#MiGroup\").val(), \"MachineId\": $(\"#MachineID\").val() },\r\n                                success: function (data) {\r\n                                    if (data.length > 0) {\r\n                                        var colum = data.split('|');\r\n                                        SetupGridGoodsType($(\"#grid\"), 1, colum.length * 2, GetColum(colum, \"PrType\"), GetColumgrid(GetColum(colum, \"PrType\"), \"TrBarCode\", \"ProductTypeID\", \"ProductTypeName\"));\r\n                                        Table_index = GetColum(colum, \"PrType\");\r\n                                        Table_Name = \"Commodity type\" + Time();\r\n                                    }\r\n                                }\r\n                            });\r\n                            break;\r\n                        case \"2\":\r\n                            GridUnload();\r\n                            SetupGridPrice($(\"#grid\"));\r\n                            Table_index = ['TrSalePrice', 'Unit price', 'Sales amount', 'Sales quantity', 'Proportion'];\r\n                            Table_Name = \"Unit price\" + Time();\r\n                            break;\r\n                        case \"3\":\r\n                            GridUnload();\r\n\r\n                            SetupGridPayType();\r\n                            Table_index = ['TrPayType', 'Payment type', 'Sales amount', 'Sales quantity', 'Proportion'];\r\n                            Table_Name = \"Payment type\" + Time();\r\n                            break;\r\n                        case \"4\":\r\n                            GridUnload();\r\n                            $.ajax({\r\n                                url: '/SaleSummarize/TableColumnList',\r\n                                type: \"post\",\r\n                                datatype: \"json\",\r\n                                data: { \"boxId\": $(\"#boxId\").val(), \"MiGroup\": $(\"#MiGroup\").val(), \"MachineId\": $(\"#MachineID\").val() },\r\n                                success: function (data) {\r\n                                    if (data.length > 0) {\r\n                                        var colum = data.split('|');\r\n                                        SetupGridTrMachineID($(\"#grid\"), 1, colum.length * 2, GetColum(colum, \"TrMachine\"), GetColumgrid(GetColum(colum, \"TrMachine\"), \"TrMachine\", \"MachineID\", \"MachineName\"));\r\n                                        Table_index = GetColum(colum, \"TrMachine\");\r\n                                        Table_Name = 'Machine ID' + Time();\r\n                                    }\r\n                                }\r\n                            });\r\n                            break;\r\n                        case \"5\":\r\n                            GridUnload();\r\n                            GridHHType($(\"#jqGrid\"));\r\n                            Table_index = ['HH', 'Machine group name', 'Machine ID', 'Machine name ', '00:00', '01:00', '02:00', '03:00', '04:00', '05:00', '06:00', '07:00', '08:00', '09:00', '10:00', '11:00', '12:00', '13:00', '14:00', '15:00', '16:00', '17:00', '18:00', '19:00', '20:00', '21:00', '22:00', '23:00', 'Total amount'];\r\n                            Table_Name = \"HH\" + Time();\r\n                            break;\r\n                        case \"6\":\r\n                            GridUnload();\r\n                            GridNewHHType($(\"#jqGrid\"));\r\n                            Table_index = ['HH', 'Machine group name', 'Machine ID', 'Machine name ', '00:00', '01:00', '02:00', '03:00', '04:00', '05:00', '06:00', '07:00', '08:00', '09:00', '10:00', '11:00', '12:00', '13:00', '14:00', '15:00', '16:00', '17:00', '18:00', '19:00', '20:00', '21:00', '22:00', '23:00', 'Total amount'];\r\n                            Table_Name = \"HH\" + Time();\r\n                            break;\r\n                    }\r\n                    $(\"#jqGrid\").trigger(\"reloadGrid\");\r\n                    $(\"#jqGrid\").setGridWidth(document.body.clientWidth - 30);\r\n                \r\n                } else {\r\n                    window.parent.getSessInfo();\r\n                }\r\n            });\r\n        }\r\n        //function ExportExecl() {\r\n        //    JsonTOCsv(JqueryDatas(\"jqGrid\"), Table_index, Table_Name + Time());\r\n        //}\r\n        //导出CSV\r\n        function ExportExecl() {\r\n            $(\"#CheckExportExecl\").modal('show');\r\n        }\r\n        //导出当前页数据到execl\r\n        function ExportExecl_Part() {\r\n            var TableData = JqueryDatas(\"jqGrid\");\r\n            JsonTOCsv(TableData, Table_index, Table_Name + Time());\r\n            $('#CheckExportExecl').modal('hide');\r\n        }\r\n        //导出全部数据到execl\r\n        function ExportExecl_All() {\r\n            var ExcelTable_index = \"\";\r\n            switch ($('#Categories').val()) {\r\n                case \"0\":\r\n                    $.ajax({\r\n                        url: '/SaleSummarize/TableColumnList1',\r\n                        type: \"post\",\r\n                        datatype: \"json\",\r\n                        data: { \"boxId\": $(\"#boxId\").val(), \"MiGroup\": $(\"#MiGroup\").val(), \"MachineId\": $(\"#MachineID\").val(), \"Statistics\": \"0\" },\r\n                        success: function (data) {\r\n\r\n                            if (data.length > 0) { \r\n\r\n                                var colum = data.split('|');\r\n                                //商品单独查询\r\n                                if ($(\"#ProNameSearch\").val() != \"\" && $(\"#ProNameSearch\").val().length > 0) {\r\n                                    ExcelTable_index = GetExcelColum(colum, \"TrBarCodePro\");\r\n                                    Table_Name = 'Product name' + Time();\r\n                                $.ajax({\r\n                                    url: '/SaleSummarize/ListJsonProExp',\r\n                                    type: \"post\",\r\n                                    datatype: \"json\",\r\n                                    data: { \"boxId\": $(\"#boxId\").val(), \"PrID\": $(\"#ProNameSearch\").val(), 'MiGroup': $('#MiGroup').val(), 'MachineID': $('#MachineID').val(), 'StartDate': $('#StartDate').val(), \"EndDate\": $(\"#EndDate\").val(), \"Statistics\": \"0\" },\r\n                                    success: function (data) {\r\n\r\n                                        JsonTOCsv(data, ExcelTable_index, Table_Name);\r\n                                    }\r\n                                });\r\n\r\n                                } else {\r\n\r\n                                    ExcelTable_index = GetExcelColum(colum, \"TrBarCode\");\r\n                                    Table_Name = 'Product name' + Time();\r\n                                $.ajax({\r\n                                    url: '/SaleSummarize/ListJsonExp',\r\n                                    type: \"post\",\r\n                                    datatype: \"json\",\r\n                                    data: { \"boxId\": $(\"#boxId\").val(), 'MiGroup': $('#MiGroup').val(), 'MachineID': $('#MachineID').val(), 'StartDate': $('#StartDate').val(), \"EndDate\": $(\"#EndDate\").val(), \"Statistics\": \"0\" },\r\n                                    success: function (data) {\r\n\r\n                                        JsonTOCsv(data, ExcelTable_index, Table_Name);\r\n                                    }\r\n                                });\r\n\r\n                                }\r\n                        \r\n                            }\r\n                        }\r\n                    });\r\n                    break;\r\n                case \"1\":\r\n                    $.ajax({\r\n                        url: '/SaleSummarize/TableColumnList',\r\n                        type: \"post\",\r\n                        datatype: \"json\",\r\n                        data: { \"boxId\": $(\"#boxId\").val(), \"MiGroup\": $(\"#MiGroup\").val(), \"MachineId\": $(\"#MachineID\").val() },\r\n                        success: function (data) {\r\n\r\n                            if (data.length > 0) {\r\n                                var colum = data.split('|');\r\n                                //SetupGridGoodsType($(\"#grid\"), 1, colum.length * 2, GetColum(colum, \"PrType\"), GetColumgrid(GetColum(colum, \"PrType\"), \"TrBarCode\", \"ProductTypeID\", \"ProductTypeName\"));\r\n                                ExcelTable_index = GetExcelColum(colum, \"PrType\");\r\n                                Table_Name = \"Commodity type\" + Time();\r\n                                \r\n                                $.ajax({\r\n                                    url: '/SaleSummarize/SaleWithGoodsTypeExp',\r\n                                    type: \"post\",\r\n                                    datatype: \"json\",\r\n                                    data: { \"boxId\": $(\"#boxId\").val(), 'MiGroup': $('#MiGroup').val(), 'MachineID': $('#MachineID').val(), 'StartDate': $('#StartDate').val(), \"EndDate\": $(\"#EndDate\").val() },\r\n                                    success: function (data) {\r\n                                        JsonTOCsv(data, ExcelTable_index, Table_Name);\r\n                                    }\r\n                                });\r\n                            }\r\n                        }\r\n                    });\r\n                    break;\r\n                case \"2\":\r\n\r\n                    ExcelTable_index = ['TrSalePrice', 'Unit price', 'Sales amount', 'Sales quantity', 'Proportion'];\r\n                    Table_Name = \"Unit price\" + Time();\r\n\r\n                    $.ajax({\r\n                        url: '/SaleSummarize/SaleWithPriceExp',\r\n                        type: \"post\",\r\n                        datatype: \"json\",\r\n                        data: { \"boxId\": $(\"#boxId\").val(),'MiGroup': $('#MiGroup').val(), 'MachineID': $('#MachineID').val(), 'StartDate': $('#StartDate').val(), \"EndDate\": $(\"#EndDate\").val() },\r\n                        success: function (data) {\r\n                            JsonTOCsv(data, ExcelTable_index, Table_Name);\r\n                        }\r\n                    });\r\n\r\n                    break;\r\n                case \"3\":\r\n                    ExcelTable_index = ['TrPayType', 'Payment type', 'Sales amount', 'Sales quantity', 'Proportion'];\r\n                    Table_Name = \"Payment type\" + Time();\r\n\r\n                    $.ajax({\r\n                        url: '/SaleSummarize/SaleWithPayTypeExp',\r\n                        type: \"post\",\r\n                        datatype: \"json\",\r\n                        data: { \"boxId\": $(\"#boxId\").val(), 'MiGroup': $('#MiGroup').val(), 'MachineID': $('#MachineID').val(), 'StartDate': $('#StartDate').val(), \"EndDate\": $(\"#EndDate\").val() },\r\n                        success: function (data) {\r\n                            \r\n                            for (var i = 0; i < data.length; i++) {\r\n                                data[i][\"PayName\"] = TrPayType(data[i].PayID, \"\", \"\");\r\n                            }\r\n                            console.log(data);\r\n                            JsonTOCsv(data, ExcelTable_index, Table_Name);\r\n                        }\r\n                    });\r\n\r\n                    break;\r\n                case \"4\":\r\n                    //window.location.href = \"/SaleSummarize/SaleMachineIDExp?MiGroup=\" + $('#MiGroup').val() + \"&MachineID=\" + $('#MachineID').val() + \"&StartDate=\" + $('#StartDate').val() + \"&EndDate=\" + $(\"#EndDate\").val();\r\n                    //$.ajax({\r\n                    //    url: '/SaleSummarize/TableColumnList',\r\n                    //    type: \"post\",\r\n                    //    datatype: \"json\",\r\n                    //    data: { \"MiGroup\": $(\"#MiGroup\").val(), \"MachineId\": $(\"#MachineID\").val() },\r\n                    //    success: function (data) {\r\n                    //\r\n                    //        if (data.length > 0) {\r\n                    //            var colum = data.split('|');\r\n                    //            //SetupGridTrMachineID($(\"#grid\"), 1, colum.length * 2, GetColum(colum, \"TrMachine\"), GetColumgrid(GetColum(colum, \"TrMachine\"), \"TrMachine\", \"MachineID\", \"MachineName\"));\r\n                    //            ExcelTable_index = GetExcelColum(colum, \"TrMachine\");\r\n                    //            Table_Name = 'Machine ID' + Time();\r\n                    //\r\n                    //            $.ajax({\r\n                    //                url: '/SaleSummarize/SaleMachineIDExp',\r\n                    //                type: \"post\",\r\n                    //                datatype: \"json\",\r\n                    //                data: { 'MiGroup': $('#MiGroup').val(), 'MachineID': $('#MachineID').val(), 'StartDate': $('#StartDate').val(), \"EndDate\": $(\"#EndDate\").val() },\r\n                    //                success: function (data) {\r\n                    //                    var Table_index2 = new Array();\r\n                    //                    //alert(Table_index)\r\n                    //                    console.log(data.length);\r\n                    //                    for (var i = 0; i < Table_index.length; i++) {\r\n                    //                        if (i == 3)\r\n                    //                            Table_index2.push(\"支付类型\");\r\n                    //                        if (i == Table_index.length - 3)\r\n                    //                            Table_index2.push(\"合计\");\r\n                    //                        Table_index2.push(Table_index[i]);\r\n                    //                    }\r\n                    //                    //alert(Table_index2)\r\n                    //                    JsonTOCsv(data, ExcelTable_index, Table_Name);\r\n                    //                }\r\n                    //            });\r\n                    //        }\r\n                    //    }\r\n                    //});\r\n\r\n                    $.post(\"/SaleSummarize/TableColumnList\", \"MiGroup=\" + $(\"#MiGroup\").val() + \"&MachineId=\" + $(\"#MachineID\").val(), function (Tabledata) {\r\n                        if (Tabledata.length > 0) {\r\n                            var colum = Tabledata.split('|');\r\n                            //表头\r\n                            ExcelTable_index = GetExcelColum(colum, \"TrMachine\");\r\n                            Table_Name = 'Machine ID' + Time();\r\n                            $.post(\"/SaleSummarize/SaleMachineIDExecl\", \"MiGroup=\" + $('#MiGroup').val() + \"&MachineID=\" + $('#MachineID').val() + \"&StartDate=\" + $('#StartDate').val() + \"&EndDate=\" + $(\"#EndDate\").val()+\"&boxId=\"+ $(\"#boxId\").val(), function (data) {\r\n                                console.log(data);\r\n                                if (data.errcode == 1) {\r\n                                    Modal_Message(\"Reportdownload\", data.errmsg);\r\n                                }else if (data.errcode == 2) {\r\n                                    Modal_Message(\"Reportdownload\", data.errmsg);\r\n                                    window.parent.getSessInfo();\r\n                                } else {\r\n                                    Modal_Message(\"Reportdownload\", data.errmsg);\r\n\r\n                                }\r\n                            })\r\n                        }\r\n                    })\r\n                    \r\n                    break;\r\n                case \"5\":\r\n                    Table_index = ['Sequence Numbers', 'Machine group name', 'Machine ID', 'Name of machine', '00:00', '01:00', '02:00', '03:00', '04:00', '05:00', '06:00', '07:00', '08:00', '09:00', '10:00', '11:00', '12:00', '13:00', '14:00', '15:00', '16:00', '17:00', '18:00', '19:00', '20:00', '21:00', '22:00', '23:00', 'Total amount'];\r\n                    Table_Name = \"24-hours sales statistics\" + Time();\r\n                    $.ajax({\r\n                        url: '/SaleSummarize/ListHHexp',\r\n                        type: \"post\",\r\n                        datatype: \"json\",\r\n                        data: { \"boxId\": $(\"#boxId\").val(),'MiGroup': $('#MiGroup').val(), 'MachineID': $('#MachineID').val(), 'StartDate': $('#StartDate').val(), \"EndDate\": $(\"#EndDate\").val() },\r\n                        success: function (data) {\r\n                            if (data.length > 0) {\r\n                                JsonTOCsv(data, Table_index, Table_Name);\r\n                            } else {\r\n                                Modal_Reserve1(\"Reportdownload\", data.errmsg);\r\n                            }                          \r\n                        }\r\n                    });\r\n                    break;\r\n                case \"6\":\r\n                    Table_index = ['Sequence Numbers', 'Machine group name', 'Machine ID', 'Name of machine',\r\n                        '00:00', '01:00', '02:00', '03:00', '04:00', '05:00', '06:00', '07:00', '08:00',\r\n                        '09:00', '10:00', '11:00', '12:00', '13:00', '14:00', '15:00', '16:00', '17:00',\r\n                        '18:00', '19:00', '20:00', '21:00', '22:00', '23:00', 'Total amount'];\r\n                    Table_Name = \"New24-hours sales statistics\" + Time();\r\n                    $.ajax({\r\n                        url: '/SaleSummarize/ListNewHHexp',\r\n             type: \"post\",\r\n             datatype: \"json\",\r\n             data: {\r\n                 \"boxId\": $(\"#boxId\").val(), 'MiGroup': $('#MiGroup').val(), 'MachineID':\r\n                     $('#MachineID').val(), 'StartDate': $('#StartDate').val(), \"EndDate\": $(\"#EndDate\").val()\r\n             },\r\n             success: function (data) {\r\n                 if (data.length > 0) {\r\n                     JsonTOCsv(data, Table_index, Table_Name);\r\n                 } else {\r\n                     Modal_Reserve1(\"Reportdownload\", data.errmsg);\r\n                 }\r\n             }\r\n         });\r\n                    break;\r\n            }\r\n            $('#CheckExportExecl').modal('hide');\r\n\r\n        }\r\n            ///获取机器组\r\n        function GetMachineGroup() {\r\n            $.post(\"/SaleSummarize/getSession\", \"\", function (data) {\r\n                if (data == \"True\") {\r\n                    $.ajax({\r\n                        url: '/SaleSummarize/GetMachineGroup',\r\n                        type: \"post\",\r\n                        datatype: \"json\",\r\n                        success: function (data) {\r\n                            var Html = \"<option value=''>--Please choose--</option>\";\r\n                            for (var i = 0; i < data.length; i++) {\r\n                                Html += \"<option value='\" + data[i].MGID + \"'>\" + data[i].MGName + \"</option>\";\r\n                            }\r\n                            $(\"#MiGroup\").html(Html);\r\n                            $(\"#MiGroup\").selectpicker('refresh');\r\n                        }\r\n                    });\r\n                } else {\r\n                    window.parent.getSessInfo();\r\n                }\r\n            });\r\n        }\r\n        ///获取商品名称\r\n        function GetProductNameList() {\r\n            $.post(\"/SaleSummarize/getSession\", \"\", function (data) {\r\n                if (data == \"True\") {\r\n                    $.ajax({\r\n                        url: '/SaleSummarize/GetProductNameList',\r\n                        type: \"post\",\r\n                        datatype: \"json\",\r\n                        success: function (data) {\r\n                            var Html = \"<option value=''>--Please choose--</option>\";\r\n                            for (var i = 0; i < data.length; i++) {\r\n                                Html += \"<option value='\" + data[i].PrID + \"'>\" + data[i].PrName + \"</option>\";\r\n                            }\r\n                            $(\"#ProNameSearch\").html(Html);\r\n                            $(\"#ProNameSearch\").selectpicker('refresh');\r\n                        }\r\n                    });\r\n                } else {\r\n                    window.parent.getSessInfo();\r\n                }\r\n            });\r\n        }\r\n        \r\n            //获取机器名称\r\n        function GetMachineID() {\r\n            $.post(\"/SaleSummarize/getSession\", \"\", function (data) {\r\n                if (data == \"True\") {\r\n                    var Group = $(\"#MiGroup\").val();\r\n                    if (Group == null) {\r\n                        return;\r\n                    }\r\n                    $.ajax({\r\n                        url: '/SaleSummarize/GetMachineID',\r\n                        type: \"post\",\r\n                        datatype: \"json\",\r\n                        data: { \"MachineGroup\": Group },\r\n                        success: function (data) {\r\n                            var Html = \"<option value=''>--Please choose--</option>\";\r\n                            for (var i = 0; i < data.length; i++) {\r\n                                Html += \"<option value='\" + data[i].MuMachineID + \"'>\" + data[i].MiAlias + \"</option>\";\r\n                            }\r\n                            $(\"#MachineID\").html(Html);\r\n                            $(\"#MachineID\").selectpicker('refresh');\r\n                        }\r\n                    });\r\n                } else {\r\n                    window.parent.getSessInfo();\r\n                }\r\n            });\r\n\r\n        }\r\n        function SetupProGrid(grid, pager, cloumcount, TableCloum, GridCloum) {\r\n            $(\"#jqGrid\").jqGrid({\r\n                url: '/SaleSummarize/ListJsonPro',\r\n                mtype: \"POST\",\r\n                styleUI: 'Bootstrap',\r\n                datatype: \"json\",\r\n                postData: { 'Categories': $('#Categories').val(),'PrID':$(\"#ProNameSearch\").val(), 'MiGroup': $('#MiGroup').val(), 'MachineID': $('#MachineID').val(), \"boxId\": $(\"#boxId\").val(), 'StartDate': $('#StartDate').val(), \"EndDate\": $(\"#EndDate\").val(), \"Statistics\": \"0\" },\r\n                colNames: TableCloum,\r\n                colModel: GridCloum,\r\n                viewrecords: true,\r\n                width: document.body.clientWidth - 50,\r\n                multiselect: false,\r\n                multiboxonly: false,\r\n                sortname: GridCloum[GridCloum.length - 2].name,\r\n                sortorder: \"asc\",\r\n                height: window.screen.height * 0.5,\r\n                shrinkToFit: false,\r\n                rowNum: 10,\r\n                rowList: [10, 20, 50, 100, 200, 500],\r\n                pager: \"#jqGridPager\"\r\n            });\r\n            $(\"#jqGrid\").jqGrid('setGroupHeaders', {\r\n                useColSpanStyle: false,\r\n                groupHeaders: [\r\n                    { startColumnName: 'ProductName', numberOfColumns: 1, titleText: '' },\r\n                    { startColumnName: GridCloum[3].name, numberOfColumns: cloumcount, titleText: '<em>Payment type</em>' },\r\n                    { startColumnName: GridCloum[GridCloum.length - 6].name, numberOfColumns: 5, titleText: '<em>Total</em>' }\r\n                ]\r\n            });\r\n\r\n                }\r\n        function SetupGrid(grid, pager, cloumcount, TableCloum, GridCloum) {\r\n            $(\"#jqGrid\").jqGrid({\r\n                url: '/SaleSummarize/ListJson',\r\n                mtype: \"POST\",\r\n                styleUI: 'Bootstrap',\r\n                datatype: \"json\",\r\n                postData: { 'Categories': $('#Categories').val(), 'MiGroup': $('#MiGroup').val(), 'MachineID': $('#MachineID').val(), \"boxId\": $(\"#boxId\").val(), 'StartDate': $('#StartDate').val(), \"EndDate\": $(\"#EndDate\").val(), \"Statistics\": \"0\" },\r\n                colNames: TableCloum,\r\n                colModel: GridCloum,\r\n                viewrecords: true,\r\n                width: document.body.clientWidth - 50,\r\n                multiselect: false,\r\n                multiboxonly: false,\r\n                sortname: GridCloum[GridCloum.length - 2].name,\r\n                sortorder: \"asc\",\r\n                height: window.screen.height * 0.5,\r\n                shrinkToFit: false,\r\n                rowNum: 10,\r\n                rowList: [10, 20, 50, 100, 200, 500],\r\n                pager: \"#jqGridPager\"\r\n            });\r\n            $(\"#jqGrid\").jqGrid('setGroupHeaders', {\r\n                useColSpanStyle: false,\r\n                groupHeaders: [\r\n                    { startColumnName: 'ProductName', numberOfColumns: 1, titleText: '' },\r\n                    { startColumnName: GridCloum[3].name, numberOfColumns: cloumcount, titleText: '<em>Payment type</em>' },\r\n                    { startColumnName: GridCloum[GridCloum.length - 6].name, numberOfColumns: 5, titleText: '<em>Total</em>' }\r\n                ]\r\n            });\r\n\r\n        }\r\n\r\n        function SetupGridGoodsType(grid, pager, cloumcount, TableCloum, GridCloum) {\r\n            $(\"#jqGrid\").jqGrid({\r\n                url: '/SaleSummarize/SaleWithGoodsType',\r\n                mtype: \"POST\",\r\n                styleUI: 'Bootstrap',\r\n                datatype: \"json\",\r\n                postData: { \"boxId\": $(\"#boxId\").val(), 'Categories': $('#Categories').val(), 'MiGroup': $('#MiGroup').val(), 'MachineID': $('#MachineID').val(), 'StartDate': $('#StartDate').val(), \"EndDate\": $(\"#EndDate\").val() },\r\n                colNames: TableCloum,\r\n                colModel: GridCloum,\r\n                viewrecords: true,\r\n                width: document.body.clientWidth - 50,\r\n                multiselect: false,\r\n                multiboxonly: false,\r\n                shrinkToFit: false,\r\n                sortname: GridCloum[GridCloum.length - 2].name,\r\n                sortorder: \"asc\",\r\n                height: window.screen.height * 0.5,\r\n                rowNum: 10,\r\n                rowList: [10, 20, 50, 100, 200, 500],\r\n                pager: \"#jqGridPager\"\r\n            });\r\n            $(\"#jqGrid\").jqGrid('setGroupHeaders', {\r\n                useColSpanStyle: false,\r\n                groupHeaders: [\r\n                    { startColumnName: GridCloum[3].name, numberOfColumns: cloumcount, titleText: '<em>Payment type</em>' },\r\n            { startColumnName: GridCloum[GridCloum.length - 5].name, numberOfColumns: 5, titleText: '<em>Total</em>' }\r\n\r\n                ]\r\n            });\r\n        }\r\n\r\n        function SetupGridPrice(grid, pager) {\r\n            $(\"#jqGrid\").jqGrid({\r\n                url: '/SaleSummarize/SaleWithPrice',\r\n                mtype: \"POST\",\r\n                styleUI: 'Bootstrap',\r\n                datatype: \"json\",\r\n                postData: { \"boxId\": $(\"#boxId\").val(), 'Categories': $('#Categories').val(), 'MiGroup': $('#MiGroup').val(), 'MachineID': $('#MachineID').val(), 'StartDate': $('#StartDate').val(), \"EndDate\": $(\"#EndDate\").val() },\r\n                colNames: ['TrSalePrice', 'Unit price', 'Sales amount', 'Sales quantity', 'Proportion'],\r\n                colModel: [\r\n                                { name: 'Price', index: 'Price', align: 'center', width: 1, hidden: true, key: true },\r\n                                { name: 'Price', index: 'Price', align: 'center', shrinkToFit: true, sortable: true, hidden: false },\r\n                                { name: 'TAmount', index: 'TAmount', align: 'center', shrinkToFit: true, sortable: true, hidden: false },\r\n                                { name: 'TCount', index: 'TCount', align: 'center', shrinkToFit: true, sortable: true, hidden: false },\r\n                                { name: 'profit', index: 'profit', align: 'center', shrinkToFit: true, sortable: true, hidden: false, formatter: ActionFormatter2 },\r\n                ],\r\n                viewrecords: true,\r\n                width: document.body.clientWidth - 50,\r\n                multiselect: false,\r\n                multiboxonly: false,\r\n                sortname: \"TAmount\",\r\n                sortorder: \"asc\",\r\n                height: window.screen.height * 0.5,\r\n                shrinkToFit: false,\r\n                rowNum: 10,\r\n                rowList: [10, 20, 50, 100, 200, 500],\r\n                pager: \"#jqGridPager\"\r\n            });\r\n\r\n\r\n        }\r\n        function TrPayType(cellvalue, options, rowdata) {\r\n            if (cellvalue == \"\" || cellvalue.length == 0)\r\n                return \"Total\";\r\n            switch (cellvalue/1) {\r\n                case 0:\r\n                    return \"Pay by cash \";\r\n          case 1:\r\n              return \"Pay with Union Pay cards\";\r\n          case 2:\r\n              return \"Pay by membership card \";\r\n          case 4:\r\n              return \"Membership Card 1 Payment\";\r\n          case 5:\r\n              return \"Pay with Union Pay cards\" + \"1\";\r\n          case 11:\r\n              return \"WeChat payment\";\r\n          case 12:\r\n              return \"Alipay face-to-face pay\";\r\n          case 13:\r\n              return \"Alipay QR Pay\";\r\n          case 15:\r\n              return \"Gift \";\r\n          case 16:\r\n              return \"One Key\";\r\n          case 17:\r\n              return \"Payment with pick-up code \";\r\n          case 65:\r\n              return \"WeChat payment\" + \"(H)\";\r\n          case 66:\r\n              return \"Alipay QR Pay\" + \"(H)\";\r\n          case 67:\r\n              return \"JD.COM\" + \"(H)\";\r\n          case 68:\r\n              return \"WeChat games (One yuan for luck)\";\r\n          case 69:\r\n              return \"Bestpay\";\r\n          case 70:\r\n              return \"ICBC QR code payment\";\r\n          case 71:\r\n              return \"WeChat membership card\";\r\n          case 72:\r\n              return \"Qpay\";\r\n          case 73:\r\n              return \"Unionpay business\";\r\n          case 74:\r\n              return \"PingAn E e-payment\";\r\n          case 75:\r\n              return \"WeChat pay by face recognition\";\r\n          case 76:\r\n              return \"Alipay face recognition payment\";\r\n          case 77:\r\n              return \"Jd aggregate payment\";\r\n          case 79:\r\n              return \"Lichu Payment\";\r\n          case 89:\r\n              return \"AlipayNFC\";\r\n          case 90:\r\n              return \"Hubtel Pay\";\r\n          case 92:\r\n              return \"Midtrans Pay\";\r\n          case 93:\r\n              return \"Paycools Pay\";\r\n          case 94:\r\n              return \"KHQR Pay\";\r\n          case 101:\r\n              return \"Remote Shipment\";\r\n          case 255:\r\n                      return \"Other Payments\";//其他支付\r\n                  default:\r\n                    return \"Total\";\r\n              }\r\n          }\r\n        function SetupGridPayType() {\r\n            $(\"#jqGrid\").jqGrid({\r\n                url: '/SaleSummarize/SaleWithPayType',\r\n                mtype: \"POST\",\r\n                styleUI: 'Bootstrap',\r\n                datatype: \"json\",\r\n                postData: { \"boxId\": $(\"#boxId\").val(), 'Categories': $('#Categories').val(), 'MiGroup': $('#MiGroup').val(), 'MachineID': $('#MachineID').val(), 'StartDate': $('#StartDate').val(), \"EndDate\": $(\"#EndDate\").val() },\r\n                colNames: ['TrPayType', 'Payment type', 'Sales amount', 'Sales quantity', 'Proportion'],\r\n                colModel: [\r\n                                { name: 'PayID', align: 'center', index: 'PayID', width: 1, hidden: true, key: true },\r\n                    { name: 'PayID', index: 'PayID', align: 'center', shrinkToFit: true, sortable: true, hidden: false, formatter: TrPayType },\r\n                                { name: 'TAmount', index: 'TAmount', align: 'center', shrinkToFit: true, sortable: true, hidden: false },\r\n                                { name: 'TCount', index: 'TCount', align: 'center', shrinkToFit: true, sortable: true, hidden: false },\r\n                                { name: 'profit', index: 'profit', align: 'center', shrinkToFit: true, sortable: true, hidden: false, formatter: ActionFormatter2 },\r\n                ],\r\n                viewrecords: true,\r\n                width: document.body.clientWidth - 50,\r\n                multiselect: false,\r\n                multiboxonly: false,\r\n                sortname: \"PayID\",\r\n                sortorder: \"asc\",\r\n                shrinkToFit: false,\r\n                height: window.screen.height * 0.5,\r\n                rowNum: 10,\r\n                rowList: [10, 20, 50, 100, 200, 500],\r\n                pager: \"#jqGridPager\"\r\n            });\r\n        }\r\n\r\n        function SetupGridTrMachineID(grid, pager, cloumcount, TableCloum, GridCloum) {\r\n            $(\"#jqGrid\").jqGrid({\r\n                url: '/SaleSummarize/SaleMachineID',\r\n                mtype: \"POST\",\r\n                styleUI: 'Bootstrap',\r\n                datatype: \"json\",\r\n                postData: {\r\n                    \"boxId\": $(\"#boxId\").val(), \"Categories\": $('#Categories').val(), \"MiGroup\": $('#MiGroup').val(), \"MachineID\": $('#MachineID').val(), 'StartDate': $('#StartDate').val(), \"EndDate\": $(\"#EndDate\").val() },\r\n                colNames: TableCloum,\r\n                colModel: GridCloum,\r\n                viewrecords: true,\r\n                width: document.body.clientWidth - 50,\r\n                multiselect: false,\r\n                multiboxonly: false,\r\n                shrinkToFit: false,\r\n                sortname: GridCloum[3].name,\r\n                sortorder: \"asc\",\r\n                height: window.screen.height * 0.5,\r\n                rowNum: 10,\r\n                rowList: [10, 20, 50, 100, 200, 500],\r\n                pager: \"#jqGridPager\", \r\n            });\r\n            $(\"#jqGrid\").jqGrid('setGroupHeaders', {\r\n                useColSpanStyle: false,\r\n                groupHeaders: [\r\n                { startColumnName: GridCloum[4].name, numberOfColumns: cloumcount, titleText: '<em>Payment type</em>' },\r\n                { startColumnName: GridCloum[GridCloum.length - 5].name, numberOfColumns: 5, titleText: '<em>Total</em>' }\r\n                ], \r\n            });\r\n        }\r\n\r\n        function GridHHType(grid, pager) {\r\n            $(\"#jqGrid\").jqGrid({\r\n                url: '/SaleSummarize/ListHH',\r\n                mtype: \"POST\",\r\n                styleUI: 'Bootstrap',\r\n                datatype: \"json\",\r\n                postData: { \"boxId\": $(\"#boxId\").val(), 'Categories': $('#Categories').val(), 'MiGroup': $('#MiGroup').val(), 'MachineID': $('#MachineID').val(), 'StartDate': $('#StartDate').val(), \"EndDate\": $(\"#EndDate\").val() },\r\n                colNames: ['HH', 'Machine group name', 'Machine ID', 'Machine name ', '00:00', '01:00', '02:00', '03:00', '04:00', '05:00', '06:00', '07:00', '08:00', '09:00', '10:00', '11:00', '12:00', '13:00', '14:00', '15:00', '16:00', '17:00', '18:00', '19:00', '20:00', '21:00', '22:00', '23:00', 'Total amount'],\r\n                colModel: [\r\n                            { name: 'HH', index: 'HH', hidden: true, key: true },\r\n                            { name: 'MGName', index: 'MGName', width: '85', align: 'center', sortable: true, hidden: false },\r\n                            { name: 'MachineID', index: 'MachineID', width: '85', align: 'center', sortable: true, hidden: false },\r\n                            { name: 'MachineName', index: 'MachineName', width: '85', align: 'center', sortable: true, hidden: false },\r\n                            { name: 'colum00', index: 'colum00', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                            { name: 'colum01', index: 'colum01', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                            { name: 'colum02', index: 'colum02', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                            { name: 'colum03', index: 'colum03', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                            { name: 'colum04', index: 'colum04', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                            { name: 'colum05', index: 'colum05', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                            { name: 'colum06', index: 'colum06', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                            { name: 'colum07', index: 'colum07', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                            { name: 'colum08', index: 'colum08', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                            { name: 'colum09', index: 'colum09', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                            { name: 'colum10', index: 'colum10', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                            { name: 'colum11', index: 'colum11', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                            { name: 'colum12', index: 'colum12', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                            { name: 'colum13', index: 'colum13', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                            { name: 'colum14', index: 'colum14', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                            { name: 'colum15', index: 'colum15', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                            { name: 'colum16', index: 'colum16', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                            { name: 'colum17', index: 'colum17', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                            { name: 'colum18', index: 'colum18', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                            { name: 'colum19', index: 'colum19', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                            { name: 'colum20', index: 'colum20', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                            { name: 'colum21', index: 'colum21', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                            { name: 'colum22', index: 'colum22', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                            { name: 'colum23', index: 'colum23', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                            { name: 'TotalAmount', index: 'TotalAmount', width: '70', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 }\r\n                ],\r\n                viewrecords: true,\r\n                width: document.body.clientWidth - 50,\r\n                multiselect: false,\r\n                multiboxonly: false,\r\n                sortname: \"MachineID\",\r\n                sortorder: \"desc\",\r\n                shrinkToFit: false,\r\n                height: window.screen.height * 0.5,\r\n                rowNum: 10,\r\n                rowList: [10, 20, 50, 100, 200, 500],\r\n                pager: \"#jqGridPager\"\r\n\r\n            });\r\n            $(\"#jqGrid\").jqGrid('setGroupHeaders', {\r\n                useColSpanStyle: false,\r\n                groupHeaders: [\r\n                    { startColumnName: 'colum00', numberOfColumns: 25, titleText: '<em>Period</em>' },\r\n                    { startColumnName: 'TotalAmount', numberOfColumns: 1, titleText: '<em>Total</em>' }\r\n                ]\r\n            });\r\n        }\r\n\r\n\r\n        function GridNewHHType(grid, pager) {\r\n            $(\"#jqGrid\").jqGrid({\r\n                url: '/SaleSummarize/ListNewHH',\r\n                mtype: \"POST\",\r\n                styleUI: 'Bootstrap',\r\n                datatype: \"json\",\r\n                postData: {\r\n                    \"boxId\": $(\"#boxId\").val(), 'Categories': $('#Categories').val(),\r\n                    'MiGroup': $('#MiGroup').val(), 'MachineID': $('#MachineID').val(), 'StartDate':\r\n                        $('#StartDate').val(), \"EndDate\": $(\"#EndDate\").val()\r\n                },\r\n                colNames: ['HH', 'Machine group name', 'Machine ID',\r\n        'Machine name ', '00:00', '01:00', '02:00', '03:00', '04:00', '05:00', '06:00', '07:00', '08:00', '09:00', '10:00', '11:00', '12:00', '13:00', '14:00', '15:00', '16:00', '17:00', '18:00', '19:00', '20:00', '21:00', '22:00', '23:00', 'Total amount'],\r\n             colModel: [\r\n                         { name: 'HH', index: 'HH', hidden: true, key: true },\r\n                         { name: 'MGName', index: 'MGName', width: '85', align: 'center', sortable: true, hidden: false },\r\n                         { name: 'MachineID', index: 'MachineID', width: '85', align: 'center', sortable: true, hidden: false },\r\n                         { name: 'MachineName', index: 'MachineName', width: '85', align: 'center', sortable: true, hidden: false },\r\n                         { name: 'colum00', index: 'colum00', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                         { name: 'colum01', index: 'colum01', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                         { name: 'colum02', index: 'colum02', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                         { name: 'colum03', index: 'colum03', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                         { name: 'colum04', index: 'colum04', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                         { name: 'colum05', index: 'colum05', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                         { name: 'colum06', index: 'colum06', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                         { name: 'colum07', index: 'colum07', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                         { name: 'colum08', index: 'colum08', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                         { name: 'colum09', index: 'colum09', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                         { name: 'colum10', index: 'colum10', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                         { name: 'colum11', index: 'colum11', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                         { name: 'colum12', index: 'colum12', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                         { name: 'colum13', index: 'colum13', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                         { name: 'colum14', index: 'colum14', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                         { name: 'colum15', index: 'colum15', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                         { name: 'colum16', index: 'colum16', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                         { name: 'colum17', index: 'colum17', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                         { name: 'colum18', index: 'colum18', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                         { name: 'colum19', index: 'colum19', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                         { name: 'colum20', index: 'colum20', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                         { name: 'colum21', index: 'colum21', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                         { name: 'colum22', index: 'colum22', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                         { name: 'colum23', index: 'colum23', width: '50', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 },\r\n                         { name: 'TotalAmount', index: 'TotalAmount', width: '70', align: 'center', sortable: true, hidden: false, formatter: ActionFormatter3 }\r\n             ],\r\n             viewrecords: true,\r\n             width: document.body.clientWidth - 50,\r\n             multiselect: false,\r\n             multiboxonly: false,\r\n             sortname: \"MachineID\",\r\n             sortorder: \"desc\",\r\n             shrinkToFit: false,\r\n             height: window.screen.height * 0.5,\r\n             rowNum: 10,\r\n             rowList: [10, 20, 50, 100, 200, 500],\r\n             pager: \"#jqGridPager\"\r\n\r\n         });\r\n         $(\"#jqGrid\").jqGrid('setGroupHeaders', {\r\n             useColSpanStyle: false,\r\n             groupHeaders: [\r\n                 { startColumnName: 'colum00', numberOfColumns: 25, titleText: '<em>Period</em>' },\r\n                 {\r\n                     startColumnName: 'TotalAmount', numberOfColumns: 1, titleText: '<em>Total</em>'\r\n                 }\r\n             ]\r\n         });\r\n        }\r\n\r\n\r\n        function showDownload() {\r\n            $.post(\"/SaleSummarize/DownloadInfo\", \"MiGroup=\" + $('#MiGroup').val() + \"&MachineID=\" + $('#MachineID').val() + \"&StartDate=\" + $('#StartDate').val() + \"&EndDate=\" + $(\"#EndDate\").val() +\"&boxId=\"+ $(\"#boxId\").val(), function () {\r\n\r\n            })\r\n        }\r\n\r\n        function showDownload1() {\r\n            $.post(\"/SaleSummarize/ListHHexpInfo\", \"MiGroup=\" + $('#MiGroup').val() + \"&MachineID=\" + $('#MachineID').val() + \"&StartDate=\" + $('#StartDate').val() + \"&EndDate=\" + $(\"#EndDate\").val() + \"&boxId=\" + $(\"#boxId\").val(), function () {\r\n\r\n            })\r\n        }\r\n\r\n        function showReserveList() {\r\n            $(\"#ReservejqGrid\").trigger(\"reloadGrid\");\r\n            $(\"#ReserveList_View\").modal('show');\r\n\r\n        }\r\n        function GetReserveList() {\r\n            $(\"#ReservejqGrid\").jqGrid({\r\n                url: '/SaleSummarize/ReserveList',\r\n                mtype: \"POST\",\r\n                styleUI: 'Bootstrap',\r\n                datatype: \"json\",\r\n                colNames: [\"ID\", 'Application time', 'Type', 'Thefile  name', 'Status', 'Operation'],\r\n                colModel: [\r\n                                { name: 'RDID', index: 'RDID', width: 1, hidden: true, key: true },\r\n                                {\r\n                                    name: 'RDTime', index: 'RDTime', align: 'center', width: 150, sortable: false, hidden: false, formatter: function (cellvalue, options, rowdata) {\r\n                                        return ChangeDateFormat(cellvalue);\r\n                                    }\r\n                                },\r\n                                { name: 'RDType', index: 'RDType', align: 'center', width: 100, sortable: false, hidden: false },\r\n                                { name: 'RDName', index: 'RDName', align: 'center', width: 300, sortable: false, hidden: false },\r\n                                {\r\n                                    name: 'RDState', index: 'RDState', align: 'center', width: 100, sortable: false, hidden: false, formatter: function (cellvalue, options, rowdata) {\r\n                                        if (cellvalue == -1) {\r\n                                            return \"Build failed\";\r\n                                        } else if (cellvalue == 0) {\r\n                                            return \"Generated\";\r\n                                        } else if (cellvalue == 1) {\r\n                                            return \"Generated complete\";\r\n                                        }\r\n                                        else {\r\n                                            return \"No Data\";\r\n                                        }\r\n                                    }\r\n                                },\r\n                                {\r\n                                    name: '', index: '', align: 'center', width: 100, sortable: false, hidden: false, formatter: function (cellvalue, options, rowdata) {\r\n                                        if (rowdata.RDState == 0) {\r\n                                            return \"<a href='javascript:void(0)' onclick='DeleteReserve(\" + rowdata.RDID + \")'>Delete</a>\";\r\n                                        } else {\r\n                                            return \"<a href='javascript:void(0)' onclick='GetReserveInfo(\" + rowdata.RDID + \")'>Download</a>  <a href='javascript:void(0)' onclick='DeleteReserve(\" + rowdata.RDID + \")'>Delete</a>\"\r\n                                        }\r\n                                    }\r\n                                }\r\n                ],\r\n                viewrecords: true,\r\n                width: 750,\r\n                multiselect: false,\r\n                multiboxonly: false,\r\n                sortname: \"RDTime\",\r\n                sortorder: \"desc\",\r\n                shrinkToFit: false,\r\n                height: window.screen.height * 0.5,\r\n                rowNum: 10,\r\n                rowList: [10, 20, 50, 100, 200],\r\n                pager: \"#ReservejqGridPager\",\r\n                caption: \"<span style='color:red'>After the report file is generated, the system will be kept for 3 days, and the expiration will be deleted automatically.</span>\"\r\n            });\r\n        }\r\n        function ChangeDateFormat(val) {\r\n            if (val != null) {\r\n                var date = new Date(parseInt(val.replace(\"/Date(\", \"\").replace(\")/\", \"\"), 10));\r\n                var month = date.getMonth() + 1 < 10 ? \"0\" + (date.getMonth() + 1) : date.getMonth() + 1;\r\n                var currentDate = date.getDate() < 10 ? \"0\" + date.getDate() : date.getDate();\r\n                return date.getFullYear() + \"-\" + month + \"-\" + currentDate + \"  \" + date.getHours() + \":\" + date.getMinutes() + \":\" + date.getSeconds();\r\n            }\r\n            return \"\";\r\n        }\r\n        function GetReserveInfo(RDID) {\r\n            $.post(\"/SaleSummarize/GetReserveUrl\", \"RDID=\" + RDID, function (data) {\r\n                console.log(data);\r\n                if (data.code == 0) {\r\n                    window.location.href = data.msg;\r\n                } else {\r\n                    Modal_Message(\"Message Box\", data.msg);\r\n                }\r\n            })\r\n        }\r\n\r\n        function DeleteReserve(RDID) {\r\n            $.post(\"/SaleSummarize/DeleteReserve\", \"RDID=\" + RDID, function (data) {\r\n                if (data.code == 0) {\r\n                    alert(data.msg);\r\n                    $(\"#ReservejqGrid\").trigger(\"reloadGrid\");\r\n                } else {\r\n                    alert(data.msg);\r\n                }\r\n            });\r\n        }\r\n\r\n        //微信绑定模式\r\n        function TypeShow() { \r\n            if ($(\"#Categories\").val() == \"0\") { \r\n                $(\"#Div_TypeHide\").show();\r\n            }  \r\n            else {// default 默认设置 \r\n                $(\"#Div_TypeHide\").hide();\r\n            }\r\n        }\r\n        function SelectClick() {\r\n            if ($(\"#Categories\").val() == \"4\") {\r\n                $(\"#ProShow\").show();\r\n            } else {\r\n                $(\"#ProShow\").hide();\r\n            }\r\n            $(\"#divType\").show();\r\n            $(\"#divReserv\").show();\r\n            if ($(\"#Categories\").val() == \"0\") {\r\n                $(\"#divProductSelection\").show();\r\n            } else {\r\n                $(\"#divProductSelection\").hide();\r\n            }\r\n\r\n            if ($(\"#Categories\").val() == \"6\") {\r\n                $(\"#divProductSelection\").hide();\r\n                $(\"#divType\").hide();\r\n                $(\"#divReserv\").hide();\r\n                $(\"#TimeType\").val(0);\r\n                daytype();\r\n            }\r\n            \r\n        } \r\n\r\n        //导出全部数据到execl\r\n        function showProReserveList() { \r\n\r\n            $.ajax({\r\n                url: '/SaleSummarize/SaleMachineIDExeclPro',\r\n                                type: \"post\",\r\n                                datatype: \"json\",\r\n                                 data: { \"boxId\": $(\"#boxId\").val(), \"MiGroup\": $(\"#MiGroup\").val(), \"MachineId\": $(\"#MachineID\").val(), \"StartDate\": $('#StartDate').val(), \"EndDate\": $(\"#EndDate\").val(), },\r\n                                success: function (data) {\r\n                                    if (data.errcode == 1) {\r\n                                        Modal_Message(\"Reportdownload\", data.errmsg);\r\n                                    } else if (data.errcode == 2) {\r\n                                        Modal_Message(\"Reportdownload\", data.errmsg);\r\n                                    window.parent.getSessInfo();\r\n                                } else {\r\n                                        Modal_Message(\"Reportdownload\", data.errmsg);\r\n                                    }\r\n                  }\r\n              });\r\n\r\n        \r\n        }\r\n\r\n    </script> \r\n    <style type=\"text/css\">\r\n        /*搜索栏*/\r\n        .ibox-title {\r\n            min-height: initial;\r\n            padding: 10px 12px;\r\n            background: #f9f9f9;\r\n        }\r\n\r\n            .ibox-title:after {\r\n                content: \"\";\r\n                display: block;\r\n                clear: both;\r\n                height: 0;\r\n                visibility: hidden;\r\n            }\r\n\r\n            .ibox-title h5 {\r\n                margin: 0;\r\n            }\r\n\r\n        .ibox-content:after {\r\n            content: \"\";\r\n            display: block;\r\n            clear: both;\r\n            height: 0;\r\n            visibility: hidden;\r\n        }\r\n\r\n        .ibox-content {\r\n            padding: 15px 20px 0 10px;\r\n        }\r\n\r\n            .ibox-content .group-left {\r\n                margin-bottom: 15px;\r\n            }\r\n\r\n        .float-e-margins .btn {\r\n            margin-bottom: 0px;\r\n        }\r\n\r\n        .ibox-content div.input-btton {\r\n            float: right;\r\n            margin-bottom: 15px;\r\n            height: auto;\r\n        }\r\n\r\n        .ibox-content .input-group.group-left label {\r\n            margin-left: 10px;\r\n            margin-top: 8px;\r\n            vertical-align: top;\r\n        }\r\n    </style>  \r\n</head>\r\n<body id=\"body\" class=\"fixed-sidebar full-height-layout pace-done\">\r\n    <div class=\"col-xs-12 col-md-12\" style=\"background-color: #f5f5f5; font-size: 14px;\">\r\n        <div class=\"col-xs-12 col-sm-12 col-md-6\" style=\"top: 4px;\"><span class=\"glyphicon glyphicon-home\">&nbspHome&nbsp</span>&gt<span>&nbspReport statistics&nbsp</span>&gt<span>&nbspSales summary&nbsp</span></div>\r\n        <div class=\"col-xs-12 col-sm-12 col-md-6\" style=\"text-align: right;\"><a href=\"javascript:location.reload();\" class=\"btn btn-success btn\"><span class=\"glyphicon glyphicon-refresh\"></span></a></div>\r\n    </div>\r\n    <div style=\"height:18px;\"></div>\r\n    <div class=\"row\" style=\"width: 98%;\">\r\n         <div class=\"col-xs-12 col-md-12\" style=\"padding:20px 0 0 0;margin-left: 20px;\">\r\n            <div class=\"col-xs-12 col-sm-12\">\r\n               <div class=\"input-group group-left\" style=\"margin-left:10px;margin-bottom:10px\">\r\n                     <div class=\"input-group group-left\">                \r\n                     <label for=\"inputEmail3\" >Type:</label>   \r\n                         </div> \r\n                     <div class=\"input-group-btn\"></div>\r\n                                 <select id=\"Categories\" class=\"form-control\"  onchange=\"SelectClick()\">\r\n\r\n                                    <option value=\"0\">Product name</option>\r\n                                    \r\n                                    <option value=\"1\">Commodity type</option>\r\n                                    \r\n                                    <option value=\"2\">Unit price</option>\r\n                                    \r\n                                    <option value=\"3\">Payment type</option>\r\n                                    \r\n                                    \r\n                                    <option value=\"4\">Machine ID</option>\r\n                                    \r\n                                    <option value=\"5\">24-hours sales statistics</option>\r\n                                               \r\n       <option value=\"6\">New24-hours sales statistics</option>\r\n                                </select>\r\n                 </div>    \r\n\r\n                           <div class=\"input-group group-left\" style=\"margin-left:10px;margin-bottom:10px\" id=\"divProductSelection\">\r\n                     <div class=\"input-group group-left\">                \r\n                     <label for=\"inputEmail3\" >Product Selection:</label>   \r\n                         </div> \r\n                     <div class=\"input-group-btn\"></div>\r\n                                 <select id=\"ProNameSearch\" class=\"form-control\"  >\r\n\r\n                                    <option value=\"\">--Please choose--</option>\r\n                            \r\n                                </select>\r\n                 </div>    \r\n\r\n                <div class=\"input-group group-left\" style=\"margin-left:10px;margin-bottom:10px\" id=\"divType\">\r\n                    <div class=\"input-group group-left\">\r\n                     <label for=\"inputEmail3\">TimeType:</label>\r\n                        </div>\r\n                              <div class=\"input-group-btn\"></div>            \r\n                                <select id=\"TimeType\" class=\"form-control\"  onchange=\"daytype()\">\r\n                                    <option value=\"0\">Statistics by day</option>\r\n                                    <option value=\"1\">Monthly statistics</option>\r\n                                    <option value=\"2\">Statistics by year</option>\r\n                                </select>\r\n                </div>\r\n                 <div class=\"input-group group-left\" style=\"margin-left:10px;margin-bottom:10px\">\r\n                        <div class=\"input-group-btn\"></div>      \r\n                 \r\n<link href=\"../../Content/bootstrap/css/bootstrap-select.min.css\" rel=\"stylesheet\" />\r\n<script src=\"../../Content/bootstrap/js/bootstrap-select.min.js\"></script>\r\n<script type=\"text/javascript\">\r\n    $(document).ready(function () {\r\n        getGroup();\r\n        $(\"#MiGroup\").change(function () { getMachineID($(this).val()); });\r\n        $('#MiGroup,#MachineID').selectpicker({\r\n            width:140,\r\n            size: 4,\r\n        });\r\n        $('.selectpicker').selectpicker('refresh');\r\n        $(\"#MachineID\").on('shown.bs.select',\r\n            function (e) {\r\n                console.log('展开之后');\r\n                $('#MachineID').prev().find(\"input\").keyup(function () {\r\n                    document.getElementById(\"MachineID\").options.selectedIndex = 0; //回到初始状态\r\n                    $(\"#MachineID\").selectpicker('refresh');//对searchPayState这个下拉框进行重置刷新\r\n                    $('#MachineID').prev().find(\"input\").attr('id', \"deviceInput\"); //为input增加id属性\r\n                    console.log($('#deviceInput').val()); //获取输入框值输出到控制台\r\n                    deviceInput = $('#deviceInput').val()\r\n                    $('#MachineID').parent().find('button').children()[0].innerHTML = deviceInput\r\n                    //console.log(deviceInput)\r\n                })\r\n            })\r\n\r\n    });\r\n    //绑定组下拉框\r\n    function getGroup() {\r\n        $.ajax({\r\n            url: '/AssetsManage/GetStringMachineGroup',\r\n            type: \"post\",\r\n            datatype: \"json\",\r\n            success: function (data1) {\r\n                var Html = \"<option value=''>--Please choose--</option>\";\r\n                    var data = JSON.parse(data1);\r\n                    for (var i = 0; i < data.length; i++) {\r\n                        Html += \"<option value='\" + data[i].MGID + \"'>\" + data[i].MGName + \"</option>\";\r\n                    }\r\n                    $(\"#MiGroup\").html(Html);\r\n                $(\"#MiGroup\").selectpicker('refresh');\r\n                }\r\n        });\r\n    };\r\n    //获取机器IDselectpicker\r\n    function getMachineID(id) {\r\n        $.ajax({\r\n            url: '/SaleSummarize/GetMachineID',\r\n             type: \"post\",\r\n             datatype: \"json\",\r\n             data: { \"MachineGroup\": id },\r\n            success: function (data) {\r\n                console.log(data)\r\n                 var Html = \"<option value=''>--Please choose--</option>\";\r\n                    for (var i = 0; i < data.length; i++) {\r\n                        Html += \"<option value='\" + data[i].MuMachineID + \"'>\" + data[i].MiAlias + \"</option>\";\r\n                    }\r\n                    $(\"#MachineID\").html(Html);\r\n                $(\"#MachineID\").selectpicker('refresh');\r\n                //console.log($(\".MachineID\").prev().find('.bs-searchbox').find('input'))\r\n                }\r\n         });\r\n    }\r\n</script>\r\n<div class=\"input-group group-left\">\r\n    <label style=\"margin-top: 8px\">Machine grouping：</label>\r\n</div>\r\n<div class=\"input-group group-left\">\r\n    <div class=\"form-group\" style=\"margin-bottom:0px\">\r\n        <select class=\"selectpicker\" data-live-search=\"true\" data-size=\"10\" id=\"MiGroup\"></select>\r\n    </div>\r\n</div>\r\n<div class=\"input-group group-left\">\r\n    <label style=\"margin-left: 10px; margin-top: 8px\">Machine ID：</label>\r\n</div>\r\n<div class=\"input-group group-left\">\r\n    <div class=\"form-group\" style=\"margin-bottom:0px\">\r\n        <select class=\"selectpicker\" data-live-search=\"true\" data-size=\"10\" id=\"MachineID\">\r\n            <option value=''>--Please choose--</option>\r\n        </select>\r\n    </div>\r\n</div>\r\n\r\n                       </div>\r\n                           \r\n               \r\n                 <div class=\"input-group group-left\" style=\"margin-left:10px;margin-bottom:10px\">\r\n                   <div class=\"input-group group-left\">\r\n                  <label for=\"inputEmail3\" >Period:</label>\r\n                       </div>\r\n                         <div class=\"input-group-btn\"></div>\r\n                                <input type=\"text\" class=\"form-control\"  id=\"StartDate\" value=\"2025-12-23\" onclick =\"Picker()\"/>\r\n                          </div>\r\n                <div class=\"input-group group-left\" style=\"margin-left:10px;margin-bottom:10px\">\r\n                    <div class=\"input-group group-left\">\r\n                            <label id=\"Label\" for=\"inputEmail3\" style=\"margin-top: 8px;\" >To:</label>\r\n                        </div>\r\n                 <div class=\"input-group-btn\"></div>\r\n                     <div class=\"input-group group-left\" id=\"EndTime\">\r\n                                <input type=\"text\" class=\"form-control\" id=\"EndDate\" value=\"2025-12-23\" onclick =\"EndDate()\"/>\r\n                          </div>\r\n                 </div>\r\n                       <div class=\"input-group group-left\">\r\n                    <label style=\"text-align:center;float:left;line-height:35px;margin:0 10px 0 15px\">Machine body ID:</label>\r\n                    <input type=\"text\" class=\"form-control\" id=\"boxId\" style=\"float:right;width:200px\" autocomplete=\"off\"/>\r\n                </div>\r\n                    <div class=\"input-group group-left\" id=\"Div_TypeHide\" style=\"display:none; margin-left:10px;margin-bottom:10px\">\r\n                        <div class=\"input-group group-left\">\r\n                         <label for=\"inputEmail3\">Statistical Type:</label>\r\n                            </div>\r\n                                  <div class=\"input-group-btn\"></div>            \r\n                                    <select id=\"Statistics\"  class=\"form-control\">\r\n                                        <option value=\"0\">--Please choose--</option>\r\n                                        <option value=\"1\">All（Including WeChat games）</option>\r\n                                        <option value=\"2\">All（Wechat games not included）</option>\r\n                                    </select>\r\n                    </div> \r\n                 <div class=\"input-group group-left\" style=\"margin-left:10px\">    \r\n                     <span><a href=\"#\" class=\"btn btn-success\" onclick=\"Search()\"><span class=\"glyphicon glyphicon-search\"></span>Query</a></span><span>&nbsp;&nbsp;</span>\r\n                     <span><a href=\"#\" class=\"btn btn-info\" onclick=\"ExportExecl()\"><span class=\"glyphicon glyphicon-export\"></span>ExcelExport</a></span><span>&nbsp;&nbsp;</span> \r\n                     <span><a  id=\"ProShow\" href=\"#\" class=\"btn btn-warning\" onclick=\"showProReserveList()\"><span class=\"glyphicon glyphicon-list\"></span>ExcelSchedule download(Commodity)</a></span><span>&nbsp;&nbsp;</span>\r\n                     <span id=\"divReserv\"><a href=\"#\" class=\"btn btn-warning\" onclick=\"showReserveList()\"><span class=\"glyphicon glyphicon-list\"></span>ExcelSchedule download</a></span><span>&nbsp;&nbsp;</span>\r\n                </div>\r\n            </div>\r\n       </div>\r\n     </div>\r\n    <hr />\r\n    <div id=\"Type\" style=\"display: none;\">\r\n        <table>\r\n            <tr>\r\n                <td>\r\n                <label>\r\n                    Graphical analysis:&nbsp&nbsp\r\n                </label>\r\n                    </td>\r\n                <td>\r\n                <select id=\"GraphType\" class=\"selectpicker form-control\" name=\"GraphType\" >\r\n                    \r\n                    <option value=\"0\">Chart</option>\r\n                    \r\n                    <option value=\"1\">Bar chart</option>\r\n                    \r\n                    <option value=\"2\">Graph</option>\r\n                    \r\n                    <option value=\"3\">Pie chart</option>\r\n                </select>\r\n                    </td>\r\n              </tr>\r\n             </table>\r\n    </div>\r\n    <br />\r\n   \r\n    <div style=\"margin-left: 20px;position:relative;\" id=\"SaleSummarizeHeight\">\r\n        <table id=\"jqGrid\"></table>\r\n        <div id=\"jqGridPager\"></div>\r\n    </div>            \r\n    <div id=\"bar_line\" style=\"margin-left: 20px; height:500px;\"></div>\r\n    <div id=\"pie\" style=\"margin-left: 20px; height:500px;\"></div>\r\n    \r\n\r\n    \r\n    <div class=\"modal fade\" id=\"CheckExportExecl\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"myModalLabel\" aria-hidden=\"true\">\r\n    <div class=\"modal-dialog\" role=\"document\" style=\"width: 359px; height: 165px\">\r\n        <div class=\"modal-content\">\r\n            <div class=\"modal-header\">\r\n                <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">\r\n                    &times;\r\n                </button>\r\n                <h4 class=\"modal-title\">Choose data to export to Excel</h4>\r\n            </div>\r\n            <div class=\"modal-body\" style=\"text-align: center;\">\r\n                <button type=\"button\" class=\"btn btn-default\" onclick=\"ExportExecl_Part()\" style=\"margin-right: 10px;\" data-toggle=\"modal\" data-target=\"#myModal\">Export the data in current page</button>\r\n                <button type=\"button\" class=\"btn btn-default\" onclick=\"ExportExecl_All()\" data-toggle=\"modal\" data-target=\"#myModal\">Export all data</button>\r\n            </div>\r\n            <div class=\"modal-footer\"></div>\r\n        </div>\r\n        <!-- /.modal-content -->\r\n    </div>\r\n    <!-- /.modal -->\r\n</div>\r\n    <!--预约下载数据 消息框-->\r\n    <div class=\"modal fade\" id=\"Reserve_View\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"myModalLabel\" aria-hidden=\"true\">\r\n        <div class=\"modal-dialog\" id=\"Div3\">\r\n            <div class=\"modal-content\">\r\n                <div class=\"modal-header\">\r\n                    <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">\r\n                        &times;\r\n                    </button>\r\n                    <h4 class=\"modal-title\" id=\"ReserveTitle\"></h4>\r\n                </div>\r\n                <div class=\"modal-body\" id=\"ReserveContent\">\r\n                </div>\r\n                <div class=\"modal-footer\">\r\n                    <button type=\"button\" class=\"btn btn-success\" data-dismiss=\"modal\" onclick=\"showDownload()\">\r\n                        Schedule download\r\n                    </button>\r\n\r\n                </div>\r\n            </div>\r\n            <!-- /.modal-content -->\r\n        </div>\r\n        <!-- /.modal -->\r\n    </div>\r\n    \r\n    <div class=\"modal fade\" id=\"Reserve_View1\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"myModalLabel\" aria-hidden=\"true\">\r\n        <div class=\"modal-dialog\" id=\"Div6\">\r\n            <div class=\"modal-content\">\r\n                <div class=\"modal-header\">\r\n                    <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">\r\n                        &times;\r\n                    </button>\r\n                    <h4 class=\"modal-title\" id=\"ReserveTitle1\"></h4>\r\n                </div>\r\n                <div class=\"modal-body\" id=\"ReserveContent1\">\r\n                </div>\r\n                <div class=\"modal-footer\">\r\n                    <button type=\"button\" class=\"btn btn-success\" data-dismiss=\"modal\" onclick=\"showDownload1()\">\r\n                        Schedule download\r\n                    </button>\r\n\r\n                </div>\r\n            </div>\r\n            <!-- /.modal-content -->\r\n        </div>\r\n        <!-- /.modal -->\r\n    </div>\r\n\r\n    <!--预约下载数据 消息框-->\r\n    <div class=\"modal fade\" id=\"ReserveList_View\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"myModalLabel\" aria-hidden=\"true\">\r\n        <div class=\"modal-dialog\" id=\"Div4\" style=\"width: 800px;\">\r\n            <div class=\"modal-content\">\r\n                <div class=\"modal-header\">\r\n                    <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">\r\n                        &times;\r\n                    </button>\r\n                    <h4 class=\"modal-title\" id=\"H1\">Schedule download data</h4>\r\n                </div>\r\n                <div class=\"modal-body\" id=\"Div5\">\r\n                    <div style=\"margin-left: 20px;position:relative;\" id=\"ReserveListHeight\">\r\n                        <table id=\"ReservejqGrid\"></table>\r\n                        <div id=\"ReservejqGridPager\"></div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <!-- /.modal-content -->\r\n        </div>\r\n        <!-- /.modal -->\r\n    </div>\r\n    <!--错误提示 消息框-->\r\n    <div class=\"modal fade\" id=\"Role_Message\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"myModalLabel\" aria-hidden=\"true\">\r\n        <div class=\"modal-dialog\" id=\"Div2\">\r\n            <div class=\"modal-content\">\r\n                <div class=\"modal-header\">\r\n                    <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-hidden=\"true\">\r\n                        &times;\r\n                    </button>\r\n                    <h4 class=\"modal-title\" id=\"MessageTitle\"></h4>\r\n                </div>\r\n                <div class=\"modal-body\" id=\"MessageContent\">\r\n                </div>\r\n                <div class=\"modal-footer\">\r\n                    <button type=\"button\" class=\"btn btn-success\" data-dismiss=\"modal\">\r\n                        Submit\r\n                    </button>\r\n                </div>\r\n            </div>\r\n            <!-- /.modal-content -->\r\n        </div>\r\n        <!-- /.modal -->\r\n    </div>\r\n</body>\r\n</html>\r\n"
}